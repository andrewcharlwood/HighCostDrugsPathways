let
    Source = Sql.Database("sqlmi-pseudo-prd-001.d7a437fc49de.database.windows.net", "PrimaryCare", [Query="select#(lf)    [Drug Name],#(lf)    [Provider Code],#(lf)    [OrganisationName],#(lf)    dp.PersonKey,#(lf)    CASE #(lf)        WHEN ISNUMERIC([Indication SNOMED Code]) = 1 #(lf)        THEN ds.SNomedDescription#(lf)        else [Indication SNOMED Code]#(lf)    END as [indication],#(lf)    [Treatment Function Code],#(lf)    [Additional Detail 1],#(lf)    [Additional Detail 2],#(lf)    [Additional Detail 3],#(lf)    [Additional Detail 4],#(lf)    [Additional Detail 5],#(lf)    [Additional Description 1],#(lf)    [Additional Description 2],#(lf)    [Additional Description 3],#(lf)    [Additional Description 4],#(lf)    [Additional Description 5],#(lf)    [NCDR Treatment Function Name],#(lf)    [Treatment Function Desc],#(lf)    [Intervention Date],#(lf)    [Price Actual]#(lf)from CDM.CDM.vw_ConMon_DrPLCM_Reporting dr#(lf)left join DataWarehouse.dwh.DimPerson dp on dr.[Pseudo NHS No Linked] = dp.[PatientPseudonym]#(lf)left join DataWarehouse.dwh.DimSnomedCode ds on dr.[Indication SNOMED Code] = ds.SnomedCode#(lf)left join DataWarehouse.dwh.DimOrganisation do on dr.[Provider Code] = do.OrganisationCode#(lf)where [Drug Name] is not null#(lf)and [PersonKey] is not null"]),
    #"Run Python script" = Python.Execute("import numpy as np#(lf)#(lf)additional_detail_columns = [""Additional Detail 1"", ""Additional Description 1"", ""Additional Detail 2"", ""Additional Description 2"",#(lf)    ""Additional Detail 3"", ""Additional Description 3"", ""Additional Detail 4"", ""Additional Description 4"",#(lf)    ""Additional Detail 5"", ""Additional Description 5"", ""NCDR Treatment Function Name"", ""Treatment Function Desc""]#(lf)directory_list = [#(lf)""DERMATOLOGY"",#(lf)""RHEUMATOLOGY"",#(lf)""OPHTHALMOLOGY"",#(lf)""TRAUMA & ORTHOPAEDICS"",#(lf)""ENT"",#(lf)""ORTHOTICS"",#(lf)""DIETETICS"",#(lf)""PAEDIATRICS"",#(lf)""GENERAL MEDICINE"",#(lf)""GASTROENTEROLOGY"",#(lf)""NEUROLOGY"",#(lf)""CLINICAL NEUROPHYSIOLOGY"",#(lf)""NEPHROLOGY"",#(lf)""MEDICAL ONCOLOGY"",#(lf)""GYNAECOLOGY"",#(lf)""GENERAL SURGERY"",#(lf)""THORACIC MEDICINE"",#(lf)""CLINICAL HAEMATOLOGY"",#(lf)""ANAESTHETICS"",#(lf)""ORAL SURGERY"",#(lf)""ENDOCRINOLOGY"",#(lf)""CRITICAL CARE MEDICINE"",#(lf)""PAIN MANAGEMENT"",#(lf)""UROLOGY"",#(lf)""BREAST SURGERY"",#(lf)""ANTICOAGULANT SERVICE"",#(lf)""COLORECTAL SURGERY"",#(lf)""CARDIOLOGY"",#(lf)""UPPER GASTROINTESTINAL SURGERY"",#(lf)""DIABETIC MEDICINE"",#(lf)""STROKE MEDICINE"",#(lf)""TRANSIENT ISCHAEMIC ATTACK"",#(lf)""PAEDIATRIC DIABETIC MEDICINE"",#(lf)""ACCIDENT & EMERGENCY"",#(lf)""VASCULAR SURGERY"",#(lf)""GYNAECOLOGICAL ONCOLOGY"",#(lf)""AUDIOLOGY"",#(lf)""OBSTETRICS"",#(lf)""MIDWIFE EPISODE"",#(lf)""PAEDIATRIC CARDIOLOGY"",#(lf)""ORTHOPTICS"",#(lf)""PAEDIATRIC UROLOGY"",#(lf)""CHEMICAL PATHOLOGY"",#(lf)""CLINICAL ONCOLOGY (PREVIOUSLY RADIOTHERAPY)"",#(lf)""NEONATOLOGY"",#(lf)""GERIATRIC MEDICINE"",#(lf)""REHABILITATION"",#(lf)""INFECTIOUS DISEASES"",#(lf)""PAEDIATRIC GASTROENTEROLOGY"",#(lf)""THORACIC SURGERY"",#(lf)""PLASTIC SURGERY"",#(lf)""CLINICAL IMMUNOLOGY"",#(lf)""MEDICAL OPHTHALMOLOGY"",#(lf)""TRANSPLANTATION SURGERY"",#(lf)""NEUROSURGERY"",#(lf)""CARDIOTHORACIC TRANSPLANTATION"",#(lf)""BLOOD AND MARROW TRANSPLANTATION""#(lf)]#(lf)#(lf)# Loop through the detail columns extracting any directory matches, using raw string for regex#(lf)for ad in additional_detail_columns:#(lf)    try:#(lf)        dataset[ad] = dataset[ad].astype(str).str.replace(r'\W', '', regex=True)#(lf)        dataset[ad] = dataset[ad].str.extract(r'({})'.format('|'.join(directory_list)), expand=False)[0]#(lf)    except AttributeError:#(lf)        pass#(lf)mapping_treatment_codes = {#(lf)    ""100"": ""GENERAL SURGERY SERVICE"",#(lf)    ""101"": ""UROLOGY SERVICE"",#(lf)    ""102"": ""TRANSPLANT SURGERY SERVICE"",#(lf)    ""103"": ""BREAST SURGERY SERVICE"",#(lf)    ""104"": ""COLORECTAL SURGERY SERVICE"",#(lf)    ""105"": ""HEPATOBILIARY AND PANCREATIC SURGERY SERVICE"",#(lf)    ""106"": ""UPPER GASTROINTESTINAL SURGERY SERVICE"",#(lf)    ""107"": ""VASCULAR SURGERY SERVICE"",#(lf)    ""108"": ""SPINAL SURGERY SERVICE"",#(lf)    ""109"": ""BARIATRIC SURGERY SERVICE"",#(lf)    ""110"": ""TRAUMA AND ORTHOPAEDIC SERVICE"",#(lf)    ""111"": ""ORTHOPAEDIC SERVICE"",#(lf)    ""113"": ""ENDOCRINE SURGERY SERVICE"",#(lf)    ""115"": ""TRAUMA SURGERY SERVICE"",#(lf)    ""120"": ""EAR NOSE AND THROAT SERVICE"",#(lf)    ""130"": ""OPHTHALMOLOGY SERVICE"",#(lf)    ""140"": ""ORAL SURGERY SERVICE"",#(lf)    ""141"": ""RESTORATIVE DENTISTRY SERVICE"",#(lf)    ""143"": ""ORTHODONTIC SERVICE"",#(lf)    ""144"": ""MAXILLOFACIAL SURGERY SERVICE"",#(lf)    ""145"": ""ORAL AND MAXILLOFACIAL SURGERY SERVICE"",#(lf)    ""150"": ""NEUROSURGICAL SERVICE"",#(lf)    ""160"": ""PLASTIC SURGERY SERVICE"",#(lf)    ""161"": ""BURNS CARE SERVICE"",#(lf)    ""170"": ""CARDIOTHORACIC SURGERY SERVICE"",#(lf)    ""172"": ""CARDIAC SURGERY SERVICE"",#(lf)    ""173"": ""THORACIC SURGERY SERVICE"",#(lf)    ""174"": ""CARDIOTHORACIC TRANSPLANTATION SERVICE"",#(lf)    ""191"": ""PAIN MANAGEMENT SERVICE"",#(lf)    ""142"": ""PAEDIATRIC DENTISTRY SERVICE"",#(lf)    ""171"": ""PAEDIATRIC SURGERY SERVICE"",#(lf)    ""211"": ""PAEDIATRIC UROLOGY SERVICE"",#(lf)    ""212"": ""PAEDIATRIC TRANSPLANTATION SURGERY SERVICE"",#(lf)    ""213"": ""PAEDIATRIC GASTROINTESTINAL SURGERY SERVICE"",#(lf)    ""214"": ""PAEDIATRIC TRAUMA AND ORTHOPAEDIC SERVICE"",#(lf)    ""215"": ""PAEDIATRIC EAR NOSE AND THROAT SERVICE"",#(lf)    ""216"": ""PAEDIATRIC OPHTHALMOLOGY SERVICE"",#(lf)    ""217"": ""PAEDIATRIC ORAL AND MAXILLOFACIAL SURGERY SERVICE"",#(lf)    ""218"": ""PAEDIATRIC NEUROSURGERY SERVICE"",#(lf)    ""219"": ""PAEDIATRIC PLASTIC SURGERY SERVICE"",#(lf)    ""220"": ""PAEDIATRIC BURNS CARE SERVICE"",#(lf)    ""221"": ""PAEDIATRIC CARDIAC SURGERY SERVICE"",#(lf)    ""222"": ""PAEDIATRIC THORACIC SURGERY SERVICE"",#(lf)    ""223"": ""PAEDIATRIC EPILEPSY SERVICE"",#(lf)    ""230"": ""PAEDIATRIC CLINICAL PHARMACOLOGY SERVICE"",#(lf)    ""240"": ""PAEDIATRIC PALLIATIVE MEDICINE SERVICE"",#(lf)    ""241"": ""PAEDIATRIC PAIN MANAGEMENT SERVICE"",#(lf)    ""242"": ""PAEDIATRIC INTENSIVE CARE SERVICE"",#(lf)    ""250"": ""PAEDIATRIC HEPATOLOGY SERVICE"",#(lf)    ""251"": ""PAEDIATRIC GASTROENTEROLOGY SERVICE"",#(lf)    ""252"": ""PAEDIATRIC ENDOCRINOLOGY SERVICE"",#(lf)    ""253"": ""PAEDIATRIC CLINICAL HAEMATOLOGY SERVICE"",#(lf)    ""254"": ""PAEDIATRIC AUDIO VESTIBULAR MEDICINE SERVICE"",#(lf)    ""255"": ""PAEDIATRIC CLINICAL IMMUNOLOGY AND ALLERGY SERVICE"",#(lf)    ""256"": ""PAEDIATRIC INFECTIOUS DISEASES SERVICE"",#(lf)    ""257"": ""PAEDIATRIC DERMATOLOGY SERVICE"",#(lf)    ""258"": ""PAEDIATRIC RESPIRATORY MEDICINE SERVICE"",#(lf)    ""259"": ""PAEDIATRIC NEPHROLOGY SERVICE"",#(lf)    ""260"": ""PAEDIATRIC MEDICAL ONCOLOGY SERVICE"",#(lf)    ""261"": ""PAEDIATRIC INHERITED METABOLIC MEDICINE SERVICE"",#(lf)    ""262"": ""PAEDIATRIC RHEUMATOLOGY SERVICE"",#(lf)    ""263"": ""PAEDIATRIC DIABETES SERVICE"",#(lf)    ""264"": ""PAEDIATRIC CYSTIC FIBROSIS SERVICE"",#(lf)    ""270"": ""PAEDIATRIC EMERGENCY MEDICINE SERVICE"",#(lf)    ""280"": ""PAEDIATRIC INTERVENTIONAL RADIOLOGY SERVICE"",#(lf)    ""290"": ""COMMUNITY PAEDIATRIC SERVICE"",#(lf)    ""291"": ""PAEDIATRIC NEURODISABILITY SERVICE"",#(lf)    ""321"": ""PAEDIATRIC CARDIOLOGY SERVICE"",#(lf)    ""421"": ""PAEDIATRIC NEUROLOGY SERVICE"",#(lf)    ""180"": ""EMERGENCY MEDICINE SERVICE"",#(lf)    ""190"": ""ANAESTHETIC SERVICE"",#(lf)    ""192"": ""INTENSIVE CARE MEDICINE SERVICE"",#(lf)    ""200"": ""AVIATION AND SPACE MEDICINE SERVICE"",#(lf)    ""300"": ""GENERAL INTERNAL MEDICINE SERVICE"",#(lf)    ""301"": ""GASTROENTEROLOGY SERVICE"",#(lf)    ""302"": ""ENDOCRINOLOGY SERVICE"",#(lf)    ""303"": ""CLINICAL HAEMATOLOGY SERVICE"",#(lf)    ""304"": ""CLINICAL PHYSIOLOGY SERVICE"",#(lf)    ""305"": ""CLINICAL PHARMACOLOGY SERVICE"",#(lf)    ""306"": ""HEPATOLOGY SERVICE"",#(lf)    ""307"": ""DIABETES SERVICE"",#(lf)    ""308"": ""BLOOD AND MARROW TRANSPLANTATION SERVICE"",#(lf)    ""309"": ""HAEMOPHILIA SERVICE"",#(lf)    ""310"": ""AUDIO VESTIBULAR MEDICINE SERVICE"",#(lf)    ""311"": ""CLINICAL GENETICS SERVICE"",#(lf)    ""313"": ""CLINICAL IMMUNOLOGY AND ALLERGY SERVICE"",#(lf)    ""314"": ""REHABILITATION MEDICINE SERVICE"",#(lf)    ""315"": ""PALLIATIVE MEDICINE SERVICE"",#(lf)    ""316"": ""CLINICAL IMMUNOLOGY SERVICE"",#(lf)    ""317"": ""ALLERGY SERVICE"",#(lf)    ""318"": ""INTERMEDIATE CARE SERVICE"",#(lf)    ""319"": ""RESPITE CARE SERVICE"",#(lf)    ""320"": ""CARDIOLOGY SERVICE"",#(lf)    ""322"": ""CLINICAL MICROBIOLOGY SERVICE"",#(lf)    ""323"": ""SPINAL INJURIES SERVICE"",#(lf)    ""324"": ""ANTICOAGULANT SERVICE"",#(lf)    ""325"": ""SPORT AND EXERCISE MEDICINE SERVICE"",#(lf)    ""326"": ""ACUTE INTERNAL MEDICINE SERVICE"",#(lf)    ""327"": ""CARDIAC REHABILITATION SERVICE"",#(lf)    ""328"": ""STROKE MEDICINE SERVICE"",#(lf)    ""329"": ""TRANSIENT ISCHAEMIC ATTACK SERVICE"",#(lf)    ""330"": ""DERMATOLOGY SERVICE"",#(lf)    ""331"": ""CONGENITAL HEART DISEASE SERVICE"",#(lf)    ""333"": ""RARE DISEASE SERVICE"",#(lf)    ""335"": ""INHERITED METABOLIC MEDICINE SERVICE"",#(lf)    ""340"": ""RESPIRATORY MEDICINE SERVICE"",#(lf)    ""341"": ""RESPIRATORY PHYSIOLOGY SERVICE"",#(lf)    ""342"": ""PULMONARY REHABILITATION SERVICE"",#(lf)    ""343"": ""ADULT CYSTIC FIBROSIS SERVICE"",#(lf)    ""344"": ""COMPLEX SPECIALISED REHABILITATION SERVICE"",#(lf)    ""345"": ""SPECIALIST REHABILITATION SERVICE"",#(lf)    ""346"": ""LOCAL SPECIALIST REHABILITATION SERVICE"",#(lf)    ""347"": ""SLEEP MEDICINE SERVICE"",#(lf)    ""348"": ""POST-COVID-19 SYNDROME SERVICE"",#(lf)    ""350"": ""INFECTIOUS DISEASES SERVICE"",#(lf)    ""352"": ""TROPICAL MEDICINE SERVICE"",#(lf)    ""360"": ""GENITOURINARY MEDICINE SERVICE"",#(lf)    ""361"": ""RENAL MEDICINE SERVICE"",#(lf)    ""370"": ""MEDICAL ONCOLOGY SERVICE"",#(lf)    ""371"": ""NUCLEAR MEDICINE SERVICE"",#(lf)    ""400"": ""NEUROLOGY SERVICE"",#(lf)    ""401"": ""CLINICAL NEUROPHYSIOLOGY SERVICE"",#(lf)    ""410"": ""RHEUMATOLOGY SERVICE"",#(lf)    ""420"": ""PAEDIATRIC SERVICE"",#(lf)    ""422"": ""NEONATAL CRITICAL CARE SERVICE"",#(lf)    ""424"": ""WELL BABY SERVICE"",#(lf)    ""430"": ""ELDERLY MEDICINE SERVICE"",#(lf)    ""431"": ""ORTHOGERIATRIC MEDICINE SERVICE"",#(lf)    ""450"": ""DENTAL MEDICINE SERVICE"",#(lf)    ""451"": ""SPECIAL CARE DENTISTRY SERVICE"",#(lf)    ""460"": ""MEDICAL OPHTHALMOLOGY SERVICE"",#(lf)    ""461"": ""OPHTHALMIC AND VISION SCIENCE SERVICE"",#(lf)    ""501"": ""OBSTETRICS SERVICE"",#(lf)    ""502"": ""GYNAECOLOGY SERVICE"",#(lf)    ""503"": ""GYNAECOLOGICAL ONCOLOGY SERVICE"",#(lf)    ""504"": ""COMMUNITY SEXUAL AND REPRODUCTIVE HEALTH SERVICE"",#(lf)    ""505"": ""FETAL MEDICINE SERVICE"",#(lf)    ""510"": ""RETIRED BUT RETAINED FOR HISTORICAL PURPOSES"",#(lf)    ""520"": ""RETIRED BUT RETAINED FOR HISTORICAL PURPOSES"",#(lf)    ""560"": ""MIDWIFERY SERVICE"",#(lf)    ""610"": ""RETIRED BUT RETAINED FOR HISTORICAL PURPOSES"",#(lf)    ""620"": ""RETIRED BUT RETAINED FOR HISTORICAL PURPOSES"",#(lf)    ""656"": ""CLINICAL PSYCHOLOGY SERVICE"",#(lf)    ""700"": ""LEARNING DISABILITY SERVICE"",#(lf)    ""710"": ""ADULT MENTAL HEALTH SERVICE"",#(lf)    ""711"": ""CHILD AND ADOLESCENT PSYCHIATRY SERVICE"",#(lf)    ""712"": ""FORENSIC PSYCHIATRY SERVICE"",#(lf)    ""713"": ""MEDICAL PSYCHOTHERAPY SERVICE"",#(lf)    ""715"": ""OLD AGE PSYCHIATRY SERVICE"",#(lf)    ""720"": ""EATING DISORDERS SERVICE"",#(lf)    ""721"": ""ADDICTION SERVICE"",#(lf)    ""722"": ""LIAISON PSYCHIATRY SERVICE"",#(lf)    ""723"": ""PSYCHIATRIC INTENSIVE CARE SERVICE"",#(lf)    ""724"": ""PERINATAL MENTAL HEALTH SERVICE"",#(lf)    ""725"": ""MENTAL HEALTH RECOVERY AND REHABILITATION SERVICE"",#(lf)    ""726"": ""MENTAL HEALTH DUAL DIAGNOSIS SERVICE"",#(lf)    ""727"": ""DEMENTIA ASSESSMENT SERVICE"",#(lf)    ""730"": ""NEUROPSYCHIATRY SERVICE"",#(lf)    ""800"": ""CLINICAL ONCOLOGY SERVICE"",#(lf)    ""811"": ""INTERVENTIONAL RADIOLOGY SERVICE"",#(lf)    ""812"": ""DIAGNOSTIC IMAGING SERVICE"",#(lf)    ""822"": ""CHEMICAL PATHOLOGY SERVICE"",#(lf)    ""832"": ""RETIRED BUT RETAINED FOR HISTORICAL PURPOSES"",#(lf)    ""834"": ""MEDICAL VIROLOGY SERVICE"",#(lf)    ""650"": ""PHYSIOTHERAPY SERVICE"",#(lf)    ""651"": ""OCCUPATIONAL THERAPY SERVICE"",#(lf)    ""652"": ""SPEECH AND LANGUAGE THERAPY SERVICE"",#(lf)    ""653"": ""PODIATRY SERVICE"",#(lf)    ""654"": ""DIETETICS SERVICE"",#(lf)    ""655"": ""ORTHOPTICS SERVICE"",#(lf)    ""657"": ""PROSTHETICS SERVICE"",#(lf)    ""658"": ""ORTHOTICS SERVICE"",#(lf)    ""659"": ""DRAMATHERAPY SERVICE"",#(lf)    ""660"": ""ART THERAPY SERVICE"",#(lf)    ""661"": ""MUSIC THERAPY SERVICE"",#(lf)    ""662"": ""OPTOMETRY SERVICE"",#(lf)    ""663"": ""PODIATRIC SURGERY SERVICE"",#(lf)    ""670"": ""UROLOGICAL PHYSIOLOGY SERVICE"",#(lf)    ""673"": ""VASCULAR PHYSIOLOGY SERVICE"",#(lf)    ""675"": ""CARDIAC PHYSIOLOGY SERVICE"",#(lf)    ""677"": ""GASTROINTESTINAL PHYSIOLOGY SERVICE"",#(lf)    ""840"": ""AUDIOLOGY SERVICE"",#(lf)    ""920"": ""DIABETIC EDUCATION SERVICE"",#(lf)    ""990"": ""RETIRED BUT RETAINED FOR HISTORICAL PURPOSES""#(lf)}#(lf)# Convert treatment function code#(lf)dataset = dataset.assign(**{#(lf)    ""Treatment Function Code"": dataset[""Treatment Function Code""].fillna(0).astype(int).map(mapping_treatment_codes)#(lf)})#(lf)dataset[""Treatment Function Code""] = dataset[""Treatment Function Code""].str.extract(r'({})'.format('|'.join(directory_list)), expand=False)[0]#(lf)dataset2 = dataset[[""PersonKey"", ""Drug Name"", ""Additional Detail 1"", ""Additional Description 1"", ""Additional Detail 2"", ""Additional Description 2"",#(lf)    ""Additional Detail 3"", ""Additional Description 3"", ""Additional Detail 4"", ""Additional Description 4"",#(lf)    ""Additional Detail 5"", ""Additional Description 5"", ""NCDR Treatment Function Name"", ""indication"", ""Treatment Function Code"", ""Treatment Function Desc""]]#(lf)#(lf)#(lf)# Need to make it so if there is no indication in ""Additional Detail 1"", it will look up ""Treatment Function Code"",#(lf)# and failing that check other rows for PersonKey match and infer from desc with highest count#(lf)dataset['Additional Detail 1'] = np.where(dataset['Additional Detail 1'].isnull(), dataset['Treatment Function Code'], dataset['Additional Detail 1'])#(lf)dataset3 = dataset.groupby(['PersonKey', ""Additional Detail 1""])[""Additional Detail 1""].count().reset_index(name=""count"")#(lf)dataset3.sort_values(""count"", ascending=False, inplace=True)#(lf)dataset3.drop_duplicates(['PersonKey'], inplace=True)#(lf)PersonKey_department_dataset = dataset3[[""PersonKey"", ""Additional Detail 1""]].set_index(""PersonKey"", drop=True)#(lf)dataset = dataset.assign(PersonKey=dataset[""PersonKey""].replace('', np.nan))#(lf)dataset = dataset.dropna(subset=['PersonKey'])#(lf)dataset[""Directory""] = dataset['PersonKey'].map(PersonKey_department_dataset[""Additional Detail 1""])#(lf)dataset.dropna(subset=['Directory'], inplace=True)",[dataset=Source]),
    dataset = #"Run Python script"{[Name="dataset"]}[Value],
    #"Rename Drug Name" = Python.Execute("#(lf)drug_dict = {""ABATACEPT"": ""ABATACEPT"",#(lf)""ABATACEPT  250MG POWDER FOR CONCENTRATE FOR SOLUTION FOR INFUSION"": ""ABATACEPT"",#(lf)""ABATACEPT - ORENCIA (HOMECARE)"": ""ABATACEPT"",#(lf)""ABATACEPT (homecare pen pack)"": ""ABATACEPT"",#(lf)""ABATACEPT (homecare syringe pack)"": ""ABATACEPT"",#(lf)""ABATACEPT (Orencia)"": ""ABATACEPT"",#(lf)""ABATACEPT 250MG POWDER FOR SOLUTION FOR INFUSION VIALS"": ""ABATACEPT"",#(lf)""ABATACEPT-ORENCIA(HOMECARE)"": ""ABATACEPT"",#(lf)""Abrocitinib"": ""Abrocitinib"",#(lf)""ACALABRUTINIB"": ""ACALABRUTINIB"",#(lf)""ADALIMUMAB"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB - AMGEVITA"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB - AMGEVITA (HOMECARE)"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB - HUMIRA (HOMECARE)"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB - IDACIO (HOMECARE)"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB - IMRALDI"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB - IMRALDI (HOMECARE)"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB (Amgevita HOMECARE)"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB (AMGEVITA)"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB (AMGEVITA) (HOME DELIVERY)"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB (Humira FOR HOMECARE THERAPY)"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB (Humira HOMECARE)"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB (HUMIRA)"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB (Idacio HOMECARE)"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB (IDACIO)"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB (IDACIO) PF PEN (H DEL)"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB (Imraldi FOR HOMECARE THERAPY)"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB (Imraldi HOMECARE)"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB (IMRALDI)"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB 40MG/0.8ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB-AMGEVITA(HOMECARE)"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB-HUMIRA(HOMECARE)"": ""ADALIMUMAB"",#(lf)""ADALIMUMAB-IDACIO(HOMECARE)"": ""ADALIMUMAB"",#(lf)""AFLIBERCEPT"": ""AFLIBERCEPT"",#(lf)""AFLIBERCEPT 4MG/100MICROLITRES SOLUTION FOR INJECTION VIALS"": ""AFLIBERCEPT"",#(lf)""AFLIBERCEPT intravitreal"": ""AFLIBERCEPT"",#(lf)""AFLIBERCEPT intravitreal (Left eye)"": ""AFLIBERCEPT"",#(lf)""AFLIBERCEPT intravitreal (Right eye)"": ""AFLIBERCEPT"",#(lf)""ALCURA (HOMECARE) CCG DELIVERY FEE"": ""N/A"",#(lf)""ALIROCUMAB"": ""ALIROCUMAB"",#(lf)""ALIROCUMAB (HOMECARE)"": ""ALIROCUMAB"",#(lf)""ALIROCUMAB (Praluent FOR HOMECARE THERAPY)"": ""ALIROCUMAB"",#(lf)""ALIROCUMAB (Praluent HOMECARE)"": ""ALIROCUMAB"",#(lf)""ALIROCUMAB 150MG/1ML SOLUTION FOR INJECTION PRE-FILLED DISPOSABLE DEVICES"": ""ALIROCUMAB"",#(lf)""Alirocumab 75mg/1ml solution for injection pre-filled disposable devices"": ""ALIROCUMAB"",#(lf)""ALIROCUMAB!150mg/1mL!PRE-FILLED"": ""ALIROCUMAB"",#(lf)""ALITRETINOIN"": ""ALITRETINOIN"",#(lf)""ALITRETINOIN (P)"": ""ALITRETINOIN"",#(lf)""AMGEVITA  40MG/0.8ML SOLUTION FOR INJECTION PRE-FILLED PEN"": ""ADALIMUMAB"",#(lf)""AMGEVITA (ADALIMUMAB)"": ""ADALIMUMAB"",#(lf)""AMGEVITA (ADALIMUMAB) Pre-filled Syringe"": ""ADALIMUMAB"",#(lf)""AMGEVITA (HOMECARE PEN PACK) ADALIMUMAB"": ""ADALIMUMAB"",#(lf)""AMGEVITA (HOMECARE PFS PACK) ADALIMUMAB"": ""ADALIMUMAB"",#(lf)""AMGEVITA 40MG/0.8ML SOLUTION FOR INJECTION PRE-FILLED PENS (AMGEN LTD)"": ""ADALIMUMAB"",#(lf)""AMGEVITA 40MG/0.8ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES (AMGEN LTD)"": ""ADALIMUMAB"",#(lf)""AMIKACIN"": ""AMIKACIN"",#(lf)""AMPHOTERICIN B LIPOSOMAL"": ""AMPHOTERICIN B LIPOSOMAL"",#(lf)""ANAKINRA"": ""ANAKINRA"",#(lf)""ANDEXANET ALFA"": ""ANDEXANET ALFA"",#(lf)""ANIDULAFUNGIN"": ""ANIDULAFUNGIN"",#(lf)""APALUTAMIDE"": ""APALUTAMIDE"",#(lf)""Apalutamide 60mg tablets"": ""APALUTAMIDE"",#(lf)""APOMORPHINE"": ""APOMORPHINE"",#(lf)""APOMORPHINE (HOMECARE)"": ""APOMORPHINE"",#(lf)""APREMILAST"": ""APREMILAST"",#(lf)""APREMILAST (FOR HOMECARE THERAPY)"": ""APREMILAST"",#(lf)""APREMILAST (HOME CARE)"": ""APREMILAST"",#(lf)""APREMILAST (HOMECARE)"": ""APREMILAST"",#(lf)""APREMILAST INITIATION PACK"": ""APREMILAST"",#(lf)""APREMILAST INITIATION PACK (HOMECARE)"": ""APREMILAST"",#(lf)""APREMILAST STARTER PACK ("": ""APREMILAST"",#(lf)""APREMILAST STARTER PACK (FOR HOMECARE THERAPY)"": ""APREMILAST"",#(lf)""APREMILAST TRITATION PACK (HOME CARE)"": ""APREMILAST"",#(lf)""APREMILAST TRITATION PACK (HOMECARE)"": ""APREMILAST"",#(lf)""APREMILAST(HOMECARE)"": ""APREMILAST"",#(lf)""ARANESP 100MICROGRAMS/0.5ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES (AMGEN LTD)"": ""DARBEPOETIN ALFA"",#(lf)""ARANESP 20MICROGRAMS/0.5ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES (AMGEN LTD)"": ""DARBEPOETIN ALFA"",#(lf)""ARANESP 30MICROGRAMS/0.3ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES (AMGEN LTD)"": ""DARBEPOETIN ALFA"",#(lf)""ATEZOLIZUMAB"": ""ATEZOLIZUMAB"",#(lf)""Avalglucosidase alfa"": ""Avalglucosidase alfa"",#(lf)""AVASTIN 100MG/4ML SOLUTION FOR INFUSION VIALS (ROCHE PRODUCTS LTD)"": ""BEVACIZUMAB"",#(lf)""Avastin 400mg/16ml solution for infusion vials (Roche Products Ltd)"": ""BEVACIZUMAB"",#(lf)""AVATROMBOPAG"": ""AVATROMBOPAG"",#(lf)""AVATROMBOPAG 20MG TABLETS"": ""AVATROMBOPAG"",#(lf)""AXITINIB"": ""AXITINIB"",#(lf)""Azacitidine 100mg powder for suspension for injection vials"": ""Azacitidine"",#(lf)""AZATHIOPRINE"": ""AZATHIOPRINE"",#(lf)""AZATHIOPRINE (FOR HOMECARE THERAPY)"": ""AZATHIOPRINE"",#(lf)""BACILLUS CALMETTE-GUERIN"": ""BACILLUS CALMETTE-GUERIN"",#(lf)""Bacillus Calmette-Guerin vaccine powder for suspension for injection 1ml vials"": ""BACILLUS CALMETTE-GUERIN"",#(lf)""BARICITINIB"": ""BARICITINIB"",#(lf)""BARICITINIB (COVID-19)"": ""BARICITINIB"",#(lf)""BARICITINIB (HOMECARE)"": ""BARICITINIB"",#(lf)""BARICITINIB (Olumiant HOMECARE)"": ""BARICITINIB"",#(lf)""BARICITINIB (Olumiant)"": ""BARICITINIB"",#(lf)""BARICITINIB (Olumiant) FOR HOMECARE THERAPY"": ""BARICITINIB"",#(lf)""BARICITINIB 4MG TABLETS"": ""BARICITINIB"",#(lf)""BARICITINIB!4mg!TABLETS"": ""BARICITINIB"",#(lf)""BARICITINIB(HOMECARE)"": ""BARICITINIB"",#(lf)""BASILIXIMAB"": ""BASILIXIMAB"",#(lf)""Bavencio 200mg/10ml concentrate for solution for infusion vials (Merck Serono Ltd)"": ""Avelumab"",#(lf)""BELIMUMAB"": ""Etanercept"",#(lf)""Bendamustine 100mg powder for solution for infusion vials"": ""Bendamustine "",#(lf)""BENEPALI (Homecare prefilled pen) ETANERCEPT"": ""BASILIXIMAB"",#(lf)""BENEPALI (Homecare prefilled syringe) ETANERCEPT"": ""BASILIXIMAB"",#(lf)""BENEPALI 50MG/1ML SOLUTION FOR INJECTION PRE-FILLED PENS (BIOGEN IDEC LTD)"": ""Etanercept"",#(lf)""BENEPALI 50MG/1ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES (BIOGEN IDEC LTD)"": ""Etanercept"",#(lf)""BENEPALI PRE-FILLED PEN  50MG INJECTION SOLUTION"": ""Etanercept"",#(lf)""BENRALIZUMAB"": ""BENRALIZUMAB"",#(lf)""BEOVU"": ""BROLUCIZUMAB "",#(lf)""BERINERT 500UNIT POWDER AND SOLVENT FOR SOLUTION FOR INJECTION VIALS (CSL BEHRING UK LTD)"": ""C1-esterase inhibitor, human"",#(lf)""BEROTRALSTAT"": ""BEROTRALSTAT"",#(lf)""BEVACIZUMAB"": ""BEVACIZUMAB"",#(lf)""BEVACIZUMAB 1.25mg in 0.05ml"": ""BEVACIZUMAB"",#(lf)""Bevacizumab 1.25mg/0.05ml solution for injection vials"": ""Bevacizumab"",#(lf)""BEVACIZUMAB 2.5mg/0.1ml"": ""BEVACIZUMAB"",#(lf)""BIMEKIZUMAB PRE-FILLED PEN (HOMECARE)"": ""BIMEKIZUMAB"",#(lf)""BLEOMYCIN 15,000UNIT POWDER FOR SOLUTION FOR INJECTION VIALS"": ""Bleomycin"",#(lf)""Bortezomib 2.5mg/1ml in Sodium chloride 0.9% solution for injection pre-filled syringes"": ""Bortezomib"",#(lf)""BORTEZOMIB 3.5MG POWDER FOR SOLUTION FOR INJECTION VIALS"": ""Bortezomib"",#(lf)""BOTOX"": ""BOTULINUM A TOXIN"",#(lf)""BOTOX  100UNIT POWDER FOR SOLUTION FOR INJECTION"": ""BOTULINUM A TOXIN"",#(lf)""BOTULINUM A TOXIN"": ""BOTULINUM A TOXIN"",#(lf)""BOTULINUM A TOXIN (Dysport)"": ""BOTULINUM A TOXIN"",#(lf)""BOTULINUM A TOXIN-HAEMAGGLUTININ COMPLEX (Botox)"": ""BOTULINUM A TOXIN"",#(lf)""BOTULINUM A TOXIN-HAEMAGGLUTININ COMPLEX (DYSPORT)"": ""BOTULINUM A TOXIN"",#(lf)""BOTULINUM TOXIN TYPE A  500UNIT POWDER FOR SOLUTION FOR INJECTION"": ""BOTULINUM A TOXIN"",#(lf)""BOTULINUM TOXIN TYPE A (BOTOX)"": ""BOTULINUM A TOXIN"",#(lf)""BOTULINUM TOXIN TYPE A (DYSPORT)"": ""BOTULINUM A TOXIN"",#(lf)""Botulinum toxin type A 100unit powder for solution for injection vials"": ""BOTULINUM A TOXIN"",#(lf)""BOTULINUM TOXIN TYPE A 500UNIT POWDER FOR SOLUTION FOR INJECTION VIALS"": ""BOTULINUM A TOXIN"",#(lf)""BOTULINUM TOXIN TYPE A 50UNIT POWDER FOR SOLUTION FOR INJECTION VIALS"": ""BOTULINUM A TOXIN"",#(lf)""BOTULINUMATOXIN"": ""BOTULINUM A TOXIN"",#(lf)""Brentuximab vedotin 50mg powder for solution for infusion vials"": ""Brentuximab vedotin "",#(lf)""BRODALUMAB"": ""BRODALUMAB"",#(lf)""BRODALUMAB (FOR HOMECARE THERAPY)"": ""N/A"",#(lf)""brolucizumab"": ""BROLUCIZUMAB "",#(lf)""Busulfan 2mg tablets"": ""Busulfan "",#(lf)""C1-ESTERASE INHIBITOR (BERINERT)"": ""C1-esterase inhibitor, human"",#(lf)""C1-esterase inhibitor 500unit powder and solvent for solution for injection vials"": ""C1-esterase inhibitor "",#(lf)""Cabometyx 40mg tablets (Ipsen Ltd)"": ""Cabozantinib"",#(lf)""Cabometyx 60mg tablets (Ipsen Ltd)"": ""Cabozantinib"",#(lf)""CABOZANTINIB"": ""CABOZANTINIB"",#(lf)""Capecitabine 150mg tablets"": ""Capecitabine"",#(lf)""Capecitabine 500mg tablets"": ""Capecitabine"",#(lf)""CAPIMUNE 100MG CAPSULES (MYLAN)"": ""ciclosporin"",#(lf)""CAPIMUNE 25MG CAPSULES (MYLAN)"": ""ciclosporin"",#(lf)""CARBOPLATIN"": ""CARBOPLATIN"",#(lf)""Carboplatin 150mg/15ml solution for infusion vials"": ""CARBOPLATIN"",#(lf)""Carboplatin 450mg/45ml solution for infusion vials"": ""CARBOPLATIN"",#(lf)""Carboplatin 50mg/5ml solution for infusion vials"": ""CARBOPLATIN"",#(lf)""Carboplatin 600mg/60ml solution for infusion vials"": ""CARBOPLATIN"",#(lf)""Caspofungin 50mg powder for solution for infusion vials"": ""Caspofungin"",#(lf)""Caspofungin 70mg powder for solution for infusion vials"": ""Caspofungin"",#(lf)""CEPHALOSPORIN"": ""CEPHALOSPORIN"",#(lf)""CERTOLIZUMAB (Homecare PEN pack )"": ""CERTOLIZUMAB PEGOL"",#(lf)""CERTOLIZUMAB (Homecare PEN pack ) PAS"": ""CERTOLIZUMAB PEGOL"",#(lf)""CERTOLIZUMAB (Homecare syringe pack )"": ""CERTOLIZUMAB PEGOL"",#(lf)""CERTOLIZUMAB (Homecare syringe pack ) PAS"": ""CERTOLIZUMAB PEGOL"",#(lf)""CERTOLIZUMAB PEGOL"": ""CERTOLIZUMAB PEGOL"",#(lf)""CERTOLIZUMAB PEGOL - CIMZIA (HOMECARE FOC)"": ""CERTOLIZUMAB PEGOL"",#(lf)""CERTOLIZUMAB PEGOL - CIMZIA (HOMECARE)"": ""CERTOLIZUMAB PEGOL"",#(lf)""CERTOLIZUMAB PEGOL (Cimzia FOR HOMECARE THERAPY)"": ""CERTOLIZUMAB PEGOL"",#(lf)""CERTOLIZUMABPEGOL-CIMZIA(HOMECARE)"": ""CERTOLIZUMAB PEGOL"",#(lf)""Cetuximab 100mg/20ml solution for infusion vials"": ""Cetuximab "",#(lf)""Chlorambucil 2mg tablets"": ""Chlorambucil"",#(lf)""CICLOSPORIN"": ""CICLOSPORIN"",#(lf)""CICLOSPORIN (CAPIMUNE)"": ""CICLOSPORIN"",#(lf)""CIMZIA 200MG/1ML SOLUTION FOR INJECTION IN A DOSE-DISPENSER CARTRIDGE (UCB PHARMA LTD)"": ""CERTOLIZUMAB PEGOL"",#(lf)""CIMZIA 200MG/1ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES (UCB PHARMA LTD)"": ""Certolizumab pegol"",#(lf)""CINACALCET"": ""CINACALCET"",#(lf)""CISPLATIN"": ""CISPLATIN"",#(lf)""Cisplatin 100mg/100ml solution for infusion vials"": ""Cisplatin"",#(lf)""Cisplatin 50mg/50ml concentrate for solution for infusion vials (Accord Healthcare Ltd)"": ""Cisplatin"",#(lf)""CO-CARELDOPA INTESTINAL GEL CASSETTE"": ""N/A"",#(lf)""COLISTIMETHATE"": ""COLISTIMETHATE"",#(lf)""COLISTIMETHATE SODIUM"": ""COLISTIMETHATE"",#(lf)""COLISTIN"": ""COLISTIN"",#(lf)""Copaxone"": ""Copaxone"",#(lf)""CYCLOPHOSPHAMIDE"": ""CYCLOPHOSPHAMIDE"",#(lf)""Cyclophosphamide 4180mg/250ml in Sodium chloride 0.9% infusion bags"": ""Cyclophosphamide"",#(lf)""DARBEPOETIN ALFA"": ""DARBEPOETIN ALFA"",#(lf)""DARBEPOETIN ALFA (HOMECARE)"": ""DARBEPOETIN ALFA"",#(lf)""DARBEPOETIN ALFA (HOMECARE) SURECLICK"": ""DARBEPOETIN ALFA"",#(lf)""DARBEPOETIN ALFA (HOMECARE) SYRINGE"": ""DARBEPOETIN ALFA"",#(lf)""Darolutamide 300mg tablets"": ""Darolutamide"",#(lf)""Dasatinib 20mg tablets"": ""Dasatinib"",#(lf)""Dasatinib 50mg tablets"": ""Dasatinib"",#(lf)""DEFERASIROX"": ""DEFERASIROX"",#(lf)""Deferasirox 360mg tablets"": ""Deferasirox"",#(lf)""Delivery charge"": ""N/A"",#(lf)""Delivery Fee East of England (Standard Ambient)"": ""N/A"",#(lf)""DELIVERY/DISPENSING/SERVICE CHARGE"": ""HOMECARE"",#(lf)""DENOSUMAB"": ""DENOSUMAB"",#(lf)""DESFERRIOXAMINE"": ""DESFERRIOXAMINE"",#(lf)""DEXAMETHASONE"": ""DEXAMETHASONE"",#(lf)""DEXAMETHASONE 700MICROGRAM INTRAVITREAL IMPLANT WITH DEVICE"": ""DEXAMETHASONE"",#(lf)""Dexrazoxane 500mg powder for solution for infusion vials"": ""Dexrazoxane"",#(lf)""DIGIFAB"": ""Digoxin immune fab"",#(lf)""DIMETHYL FUMARATE"": ""DIMETHYL FUMARATE"",#(lf)""DIMETHYL FUMARATE (SKILARENCE)"": ""DIMETHYL FUMARATE"",#(lf)""Dimethyl fumarate 120mg gastro-resistant tablets"": ""Dimethyl"",#(lf)""DIMETHYL FUMERATE"": ""DIMETHYL FUMARATE"",#(lf)""DOCETAXEL"": ""DOCETAXEL"",#(lf)""Docetaxel 160mg/8ml solution for infusion vials"": ""Docetaxel"",#(lf)""Docetaxel 20mg/1ml solution for infusion vials"": ""Docetaxel"",#(lf)""Docetaxel 80mg/4ml solution for infusion vials"": ""Docetaxel"",#(lf)""DOXORUBICIN"": ""DOXORUBICIN"",#(lf)""DOXORUBICIN LIPOSOMAL PEGYLATED"": ""DOXORUBICIN"",#(lf)""DULAGLUTIDE"": ""DULAGLUTIDE"",#(lf)""DUPILUMAB"": ""DUPILUMAB"",#(lf)""DUPILUMAB (Dupixent FOR HOMECARE THERAPY)"": ""DUPILUMAB"",#(lf)""DUPILUMAB (FOC)"": ""DUPILUMAB"",#(lf)""DUPILUMAB (HOMECARE)"": ""DUPILUMAB"",#(lf)""DUPILUMAB (HOMECARE) DUPIXENT"": ""DUPILUMAB"",#(lf)""DUPILUMAB (HOMECARE) DUPIXENT PFS"": ""DUPILUMAB"",#(lf)""DUPILUMAB(HOMECARE)"": ""DUPILUMAB"",#(lf)""DUPIXENT 300MG/2ML SOLUTION FOR INJECTION PRE-FILLED PENS (SANOFI)"": ""DUPILUMAB"",#(lf)""DUPIXENT 300MG/2ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES (SANOFI)"": ""Dupilumab"",#(lf)""DYSPORT"": ""BOTULINUM A TOXIN"",#(lf)""DYSPORT  500UNIT POWDER FOR SOLUTION FOR INJECTION"": ""BOTULINUM A TOXIN"",#(lf)""East of Eng FW lot 1&2 ambient standard delivery"": ""N/A"",#(lf)""Ecalta 100mg powder for concentrate for solution for infusion vials (Pfizer Ltd)"": ""Anidulafungin"",#(lf)""ECULIZUMAB"": ""ECULIZUMAB"",#(lf)""EFUDIX 5% CREAM (MYLAN)"": ""EFUDIX"",#(lf)""ELTROMBOPAG"": ""ELTROMBOPAG"",#(lf)""ELTROMBOPAG  75MG TABLETS"": ""ELTROMBOPAG"",#(lf)""ELTROMBOPAG (HOMECARE)"": ""ELTROMBOPAG"",#(lf)""Eltrombopag 25mg tablets"": ""Eltrombopag"",#(lf)""ELTROMBOPAG 50MG TABLETS"": ""ELTROMBOPAG"",#(lf)""Emtricitabine 200mg / Tenofovir alafenamide 25mg tablets"": ""Emtricitabine"",#(lf)""ENBREL (homecare pen pack) ETANERCEPT"": ""ETANERCEPT"",#(lf)""ENBREL (Homecare prefilled syringe) ETANERCEPT"": ""ETANERCEPT"",#(lf)""ENBREL (homecare vial pack) ETANERCEPT"": ""ETANERCEPT"",#(lf)""ENBREL 25MG POWDER AND SOLVENT FOR SOLUTION FOR INJECTION VIALS (PFIZER LTD)"": ""Etanercept"",#(lf)""ENBREL 50MG/1ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES (PFIZER LTD)"": ""Etanercept"",#(lf)""ENHERTU 100MG POWDER FOR CONCENTRATE FOR SOLUTION FOR INFUSION VIALS (DAIICHI SANKYO UK LTD)"": ""TRASTUZUMAB"",#(lf)""ENZALUTAMIDE"": ""ENZALUTAMIDE"",#(lf)""EPIRUBICIN"": ""EPIRUBICIN"",#(lf)""EPIRUBICIN 200MG/100ML SOLUTION FOR INFUSION VIALS"": ""EPIRUBICIN"",#(lf)""EPIRUBICIN 50MG POWDER FOR SOLUTION FOR INJECTION VIALS"": ""EPIRUBICIN"",#(lf)""EPOETIN ALFA"": ""EPOETIN ALFA"",#(lf)""EPOETIN ALFA (EPREX Pre-filled Syringe)"": ""EPOETIN ALFA"",#(lf)""EPOETIN ALFA (EPREX)"": ""EPOETIN ALFA"",#(lf)""EPOETIN ALFA (EPREX) (HOMECARE)"": ""EPOETIN ALFA"",#(lf)""Epoetin alfa 2,000units/0.5ml solution for injection pre-filled syringes"": ""Epoetin"",#(lf)""Epoetin alfa 3,000units/0.3ml solution for injection pre-filled syringes"": ""Epoetin"",#(lf)""Epoetin alfa 4,000units/0.4ml solution for injection pre-filled syringes"": ""Epoetin"",#(lf)""Epoetin alfa 5,000units/0.5ml solution for injection pre-filled syringes"": ""Epoetin"",#(lf)""Epoetin alfa 6,000units/0.6ml solution for injection pre-filled syringes"": ""Epoetin"",#(lf)""EPOETIN BETA (NEORECORMON pre-filled syringe HOMECARE)"": ""EPOETIN BETA"",#(lf)""EPOETIN BETA (NEORECORMON Pre-filled syringe)"": ""EPOETIN BETA"",#(lf)""EPOETIN BETA (NEORECORMON) HOMECARE"": ""EPOETIN BETA"",#(lf)""Erbitux 500mg/100ml solution for infusion vials (Merck Serono Ltd)"": ""Cetuximab"",#(lf)""ERELZI 50MG/1ML SOLUTION FOR INJECTION PRE-FILLED PENS (SANDOZ LTD)"": ""Etanercept"",#(lf)""ERELZI 50MG/1ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES (SANDOZ LTD)"": ""Etanercept"",#(lf)""ERENUMAB"": ""ERENUMAB"",#(lf)""ETANERCEPT"": ""ETANERCEPT"",#(lf)""ETANERCEPT - BENEPALI"": ""ETANERCEPT"",#(lf)""ETANERCEPT - BENEPALI (HOMECARE)"": ""ETANERCEPT"",#(lf)""ETANERCEPT - ENBREL (HOMECARE)"": ""ETANERCEPT"",#(lf)""ETANERCEPT - ENBREL MYCLIC (HOMECARE)"": ""ETANERCEPT"",#(lf)""ETANERCEPT - ENBREL, 'MYCLIC' (HOMECARE)"": ""ETANERCEPT"",#(lf)""ETANERCEPT - ERELZI (HOMECARE)"": ""ETANERCEPT"",#(lf)""ETANERCEPT (BENEPALI FOR HOMECARE THERAPY)"": ""ETANERCEPT"",#(lf)""ETANERCEPT (BENEPALI)"": ""ETANERCEPT"",#(lf)""ETANERCEPT (BENEPALI) (HOME DELIVERY)"": ""ETANERCEPT"",#(lf)""ETANERCEPT (ENBREL FOR HOMECARE THERAPY) MYCLIC"": ""ETANERCEPT"",#(lf)""ETANERCEPT (ENBREL)"": ""ETANERCEPT"",#(lf)""ETANERCEPT-BENEPALI(HOMECARE)"": ""ETANERCEPT"",#(lf)""ETANERCEPT-ENBREL(HOMECARE)"": ""ETANERCEPT"",#(lf)""ETANERCEPT-ENBREL,'MYCLIC'(HOMECARE)"": ""ETANERCEPT"",#(lf)""ETANERCEPT-ERELZI(HOMECARE)"": ""ETANERCEPT"",#(lf)""EVOLOCUMAB"": ""EVOLOCUMAB"",#(lf)""EVOLOCUMAB (Repatha HOMECARE)"": ""EVOLOCUMAB"",#(lf)""EVOLOCUMAB (REPATHA SURE CLICK)(HOMECARE)"": ""EVOLOCUMAB"",#(lf)""EVOLOCUMAB SURE CLICK (HOMECARE)"": ""EVOLOCUMAB"",#(lf)""EVOLOCUMAB!140mg/1mL!PRE-FILLED"": ""EVOLOCUMAB"",#(lf)""EVOLOCUMAB(REPATHASURECLICK)(HOMECARE)"": ""EVOLOCUMAB"",#(lf)""EYLEA"": ""AFLIBERCEPT"",#(lf)""EYLEA 3.6MG/90MICROLITRES SOLUTION FOR INJECTION PRE-FILLED SYRINGES (BAYER PLC)"": ""Aflibercept"",#(lf)""FARICIMAB"": ""FARICIMAB"",#(lf)""FARICIMAB (Left eye)"": ""FARICIMAB"",#(lf)""FARICIMAB (Right eye)"": ""FARICIMAB"",#(lf)""FARICIMAB (Vabysmo)"": ""FARICIMAB"",#(lf)""FARICIMAB 28.8MG/0.24ML SOLUTION FOR INJECTION VIALS"": ""FARICIMAB"",#(lf)""FASENRA"": ""N/A"",#(lf)""FEIBA"": ""N/A"",#(lf)""FIDAXOMICIN"": ""FIDAXOMICIN"",#(lf)""FILGOTINIB"": ""FILGOTINIB"",#(lf)""FILGOTINIB (HOMECARE)"": ""FILGOTINIB"",#(lf)""FILGOTINIB (Jyseleca FOR HOMECARE THERAPY)"": ""FILGOTINIB"",#(lf)""FILGOTINIB(HOMECARE)"": ""FILGOTINIB"",#(lf)""FILGRASTIM"": ""FILGRASTIM"",#(lf)""FLUOCINOLONE ACETONIDE"": ""FLUOCINOLONE ACETONIDE"",#(lf)""FLUOCINOLONE ACETONIDE 190MICROGRAM INTRAVITREAL IMPLANT WITH DEVICE"": ""FLUOCINOLONE"",#(lf)""FLUOROURACIL"": ""FLUOROURACIL"",#(lf)""FLUOROURACIL  pre-filled syringe"": ""FLUOROURACIL"",#(lf)""FLUOROURACIL 2.5G/50ML SOLUTION FOR INFUSION VIALS"": ""FLUOROURACIL"",#(lf)""FLUOROURACIL 250MG/10ML SOLUTION FOR INJECTION VIALS"": ""FLUOROURACIL"",#(lf)""FLUOROURACIL 500MG/10ML SOLUTION FOR INJECTION VIALS"": ""FLUOROURACIL"",#(lf)""FLUOROURACIL 500MG/20ML SOLUTION FOR INJECTION VIALS"": ""FLUOROURACIL"",#(lf)""FLUOROURACIL 600MG/24ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES"": ""FLUOROURACIL"",#(lf)""FOMEPIZOLE"": ""FOMEPIZOLE"",#(lf)""FOMEPIZOLE 1.5g in 1.5mL"": ""FOMEPIZOLE"",#(lf)""FOMEPIZOLE 1.5G/1.5ML SOLUTION FOR INFUSION VIALS"": ""FOMEPIZOLE"",#(lf)""FORSTEO (Homecare prefilled pen) TERIPARATIDE"": ""FORSTEO"",#(lf)""FOSTAMATINIB"": ""FOSTAMATINIB"",#(lf)""FOSTAMATINIB (HOMECARE)"": ""FOSTAMATINIB"",#(lf)""FREESTYLE LIBRE 2 GLUCOSE MONITORING READER"": ""N/A"",#(lf)""FREESTYLE LIBRE 2 GLUCOSE MONITORING SENSOR"": ""N/A"",#(lf)""FREESTYLE LIBRE GLUCOSE MONITORING READER"": ""N/A"",#(lf)""FREESTYLE LIBRE GLUCOSE MONITORING SENSOR"": ""N/A"",#(lf)""FREESTYLELIBRE2GLUCOSEMONITORINGREADER"": ""N/A"",#(lf)""FREESTYLELIBRE2GLUCOSEMONITORINGSENSOR"": ""N/A"",#(lf)""FREMANEZUMAB"": ""FREMANEZUMAB"",#(lf)""FREMANEZUMAB (ALCURA HOMECARE)"": ""FREMANEZUMAB"",#(lf)""FREMANEZUMAB (HOMECARE)"": ""FREMANEZUMAB"",#(lf)""FREMANEZUMAB 225MG/1.5ML SOLUTION FOR INJECTION PRE-FILLED DISPOSABLE DEVICES"": ""FREMANEZUMAB"",#(lf)""FREMANEZUMAB 225MG/1.5ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES"": ""FREMANEZUMAB"",#(lf)""FREMANEZUMAB!225mg/1.5mL!PRE-FILLED"": ""FREMANEZUMAB"",#(lf)""FRESENIUS (HOMECARE) 12/16 WEEKLY DELIVERY FEE"": ""FREMANEZUMAB"",#(lf)""FRESENIUS (HOMECARE) 8 WEEKLY DELIVERY FEE"": ""FREMANEZUMAB"",#(lf)""FRESENIUS (HOMECARE) DELIVERY FEE"": ""HOMECARE"",#(lf)""FULVESTRANT"": ""FULVESTRANT"",#(lf)""FULVESTRANT (2 x 250mg syringe pack)"": ""FULVESTRANT"",#(lf)""Galcanezumab"": ""GALCANEZUMAB"",#(lf)""GALCANEZUMAB (EMGALITY) (HOMECARE PEN)"": ""GALCANEZUMAB"",#(lf)""GALCANEZUMAB (HOMECARE)"": ""GOLIMUMAB"",#(lf)""Galcanezumab 120mg/1ml solution for injection pre-filled disposable devices"": ""Galcanezumab"",#(lf)""GEMCITABINE"": ""GEMCITABINE"",#(lf)""Generic Palforzia initial dose escalation pack"": ""Palforzia"",#(lf)""GENERIC TRIOMEL 7G/LITRE NITROGEN 1140KCAL/LITRE WITH ELECTROLYTES INFUSION 1.5LITRE BAGS"": ""GENERIC"",#(lf)""Genotropin 12mg powder and solvent for solution for injection cartridges (Pfizer Ltd)"": ""Somatropin"",#(lf)""GENOTROPIN GOQUICK 5.3MG POWDER AND SOLVENT FOR SOLUTION FOR INJECTION PRE-FILLED PEN (PFIZER LTD)"": ""GENOTROPIN"",#(lf)""GLOFITAMAB"": ""GLOFITAMAB"",#(lf)""GOLIMUMAB"": ""GOLIMUMAB"",#(lf)""GOLIMUMAB (Homecare)"": ""GOLIMUMAB"",#(lf)""GOLIMUMAB (Simponi FOR HOMECARE THERAPY)"": ""GOLIMUMAB"",#(lf)""GOLIMUMAB (SIMPONI) - PEN  (HOMECARE)"": ""GOLIMUMAB"",#(lf)""GOLIMUMAB (SIMPONI) - PEN (HOMECARE)"": ""GOLIMUMAB"",#(lf)""GOLIMUMAB (SIMPONI) - PRE-FILLED SYRINGE (HOMECARE)"": ""GOLIMUMAB"",#(lf)""GOLIMUMAB 50MG/0.5ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES"": ""GOLIMUMAB"",#(lf)""GOLIMUMAB!50mg/0.5mL!PRE-FILLED"": ""GOLIMUMAB"",#(lf)""GOLIMUMAB(SIMPONI)-PEN(HOMECARE)"": ""GOLIMUMAB"",#(lf)""GOLIMUMAB(SIMPONI)-PRE-FILLEDSYRINGE(HOMECARE)"": ""GOLIMUMAB"",#(lf)""GUSELKUMAB"": ""GUSELKUMAB"",#(lf)""GUSELKUMAB (FOR HOMECARE THERAPY)"": ""GUSELKUMAB"",#(lf)""Guselkumab (HOMECARE)"": ""GUSELKUMAB"",#(lf)""HC ADALIMUMAB (AMGEVITA) 40 MG PENSET"": ""ADALIMUMAB"",#(lf)""HC ADALIMUMAB (AMGEVITA) 40MG/0.8ML PREFILLED SYRINGE"": ""ADALIMUMAB"",#(lf)""HC ADALIMUMAB (IDACIO) 40MG/0.8ML PEN"": ""HC"",#(lf)""HC ADALIMUMAB (YUFLYMA) 40MG/0.4ML PRE-FILLED PEN"": ""ADALIMUMAB"",#(lf)""HC ERENUMAB (AIMOVIG) 140MG/1ML PRE-FILLED PEN"": ""ERENUMAB"",#(lf)""HC ETANERCEPT (BENEPALI) 50 MG PEN"": ""ETANERCEPT"",#(lf)""HC FREMANEZUMAB (AJOVY) 225MG/1.5ML SOLUTION FOR INJECTION PRE-FILLED PEN"": ""HC"",#(lf)""HC GALCANEZUMAB (EMGALITY) 120MG/1ML SOLUTION FOR INJECTION PRE-FILLED PEN"": ""HC"",#(lf)""HC OMNITROPE 10 MG PEN"": ""SOMATROPIN"",#(lf)""HC OMNITROPE SUREPAL 5 MG"": ""OMNITROPE"",#(lf)""HC SECUKINUMAB (COSENTYX) 300MG/2ML PEN"": ""SECUKINUMAB"",#(lf)""HC SOMATROPIN (RBE) GENOTROPIN MINIQUICK INJECTION 0.2MG (0.6IU)"": ""SOMATROPIN"",#(lf)""HC TOCILIZUMAB  162MG INJECTION"": ""TOCILIZUMAB"",#(lf)""HC VEDOLIZUMAB (ENTYVIO) 108MG PRE-FILLED PEN"": ""VEDOLIZUMAB"",#(lf)""HEALTHCARE AT HOME (HOMECARE) 24 WEEKLY DELIVERY FEE"": ""N/A"",#(lf)""HEALTHCARE AT HOME (HOMECARE) 4-12 WEEKLY DELIVERY FEE"": ""N/A"",#(lf)""HIV HOMECARE DELIVERY CHARGE"": ""HOMECARE"",#(lf)""HOMECARE DELIVERY CHARGE"": ""HOMECARE"",#(lf)""HUMIRA (homecare pen pack) ADALIMUMAB"": ""ADALIMUMAB"",#(lf)""HUMIRA (homecare syringe pack) ADALIMUMAB"": ""ADALIMUMAB"",#(lf)""HUMIRA 40MG/0.4ML SOLUTION FOR INJECTION PRE-FILLED PENS (ABBVIE LTD)"": ""Adalimumab"",#(lf)""HUMIRA 40MG/0.4ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES (ABBVIE LTD)"": ""ADALIMUMAB"",#(lf)""HUMIRA 40MG/0.8ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES (ABBVIE LTD)"": ""Adalimumab"",#(lf)""HUMULIN R"": ""HUMULIN R"",#(lf)""HUMULIN R (INSULIN) KWIKPEN"": ""N/A"",#(lf)""HUMULIN R KWIKPEN 500UNITS/ML SOLUTION FOR INJECTION 3ML PRE-FILLED PENS (IMPORTED (UNITED STATES))"": ""Insulin human"",#(lf)""HUMULINR(INSULIN)KWIKPEN"": ""N/A"",#(lf)""HYDROXYCARBAMIDE"": ""HYDROXYCARBAMIDE"",#(lf)""HYDROXYCARBAMIDE (HOMECARE)"": ""HYDROXYCARBAMIDE"",#(lf)""Hydroxycarbamide 500mg/5ml oral solution"": ""Hydroxycarbamide"",#(lf)""Ibrance 100mg capsules (Pfizer Ltd)"": ""Palbociclib"",#(lf)""Ibrance 125mg capsules (Pfizer Ltd)"": ""Palbociclib"",#(lf)""Ibrance 75mg capsules (Pfizer Ltd)"": ""Palbociclib"",#(lf)""IDACIO (ADALIMUMAB)"": ""ADALIMUMAB"",#(lf)""IDACIO (HOMECARE PEN PACK) ADALIMUMAB"": ""ADALIMUMAB"",#(lf)""IDACIO (HOMECARE SYRINGE PACK) ADALIMUMAB"": ""ADALIMUMAB"",#(lf)""IDACIO 40MG/0.8ML SOLUTION FOR INJECTION PRE-FILLED PENS (FRESENIUS KABI LTD)"": ""Adalimumab"",#(lf)""Idarubicin 10mg capsules"": ""Idarubicin"",#(lf)""IDARUCIZUMAB"": ""IDARUCIZUMAB"",#(lf)""Ifosfamide 1g powder for solution for injection vials"": ""Ifosfamide"",#(lf)""Ifosfamide 2g powder for solution for injection vials"": ""Ifosfamide"",#(lf)""ILOPROST"": ""ILOPROST"",#(lf)""ILOPROST  (see Note 5)"": ""see"",#(lf)""Iloprost 50micrograms/0.5ml solution for infusion ampoules"": ""Iloprost"",#(lf)""Imatinib 100mg capsules"": ""Imatinib"",#(lf)""Imatinib 400mg tablets"": ""Imatinib"",#(lf)""Imbruvica 140mg tablets (Janssen-Cilag Ltd)"": ""Ibrutinib"",#(lf)""Imbruvica 420mg tablets (Janssen-Cilag Ltd)"": ""Ibrutinib"",#(lf)""Imbruvica 560mg tablets (Janssen-Cilag Ltd)"": ""Ibrutinib"",#(lf)""IMRALDI (HOMECARE PEN PACK) ADALIMUMAB"": ""HOMECARE"",#(lf)""IMRALDI (HOMECARE SYRINGE PACK) ADALIMUMAB"": ""ADALIMUMAB"",#(lf)""IMRALDI 40MG/0.8ML SOLUTION FOR INJECTION PRE-FILLED PENS (BIOGEN IDEC LTD)"": ""ADALIMUMAB"",#(lf)""IMRALDI 40MG/0.8ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES (BIOGEN IDEC LTD)"": ""ADALIMUMAB"",#(lf)""IMRALDI ADALIMUMAB"": ""ADALIMUMAB"",#(lf)""INFLECTRA 100MG POWDER FOR CONCENTRATE FOR SOLUTION FOR INFUSION VIALS (PFIZER LTD)"": ""INFLIXIMAB"",#(lf)""INFLIXIMAB"": ""INFLIXIMAB"",#(lf)""INFLIXIMAB - INFLECTRA"": ""INFLIXIMAB"",#(lf)""INFLIXIMAB - REMICADE"": ""INFLIXIMAB"",#(lf)""INFLIXIMAB - REMSIMA"": ""INFLIXIMAB"",#(lf)""INFLIXIMAB (Homecare - Remsima)"": ""INFLIXIMAB"",#(lf)""INFLIXIMAB (HOMECARE PEN PACK) REMSIMA"": ""HOMECARE"",#(lf)""INFLIXIMAB (Inflectra)"": ""INFLIXIMAB"",#(lf)""INFLIXIMAB (REMICADE)"": ""INFLIXIMAB"",#(lf)""INFLIXIMAB (Remsima)"": ""INFLIXIMAB"",#(lf)""Infliximab 100mg powder for solution for infusion vials"": ""Infliximab"",#(lf)""INFLIXIMAB-REMICADE"": ""INFLIXIMAB"",#(lf)""Inlyta 5mg tablets (Pfizer Ltd)"": ""Axitinib"",#(lf)""INTERFERON BETA-1A"": ""INTERFERON BETA-1A"",#(lf)""IRINOTECAN"": ""IRINOTECAN"",#(lf)""ISATUXIMAB"": ""ISATUXIMAB"",#(lf)""IXEKIZUMAB"": ""IXEKIZUMAB"",#(lf)""IXEKIZUMAB (HEALTHCARE AT HOME - HOMECARE)"": ""IXEKIZUMAB"",#(lf)""IXEKIZUMAB (HOMECARE PEN PACK)"": ""IXEKIZUMAB"",#(lf)""IXEKIZUMAB (Taltz FOR HOMECARE THERAPY)"": ""IXEKIZUMAB"",#(lf)""IXEKIZUMAB (Taltz HOMECARE)"": ""IXEKIZUMAB"",#(lf)""IXEKIZUMAB (Taltz HOMECARE) FROM SCIENSUS"": ""IXEKIZUMAB"",#(lf)""IXEKIZUMAB (Taltz HOMECARE) PAS ONE POUND"": ""IXEKIZUMAB"",#(lf)""IXEKIZUMAB (Taltz HOMECARE) PAS ONE POUND - SCIENSUS"": ""IXEKIZUMAB"",#(lf)""IXEKIZUMAB 80MG/1ML SOLUTION FOR INJECTION PRE-FILLED DISPOSABLE DEVICES"": ""IXEKIZUMAB"",#(lf)""IXEKIZUMAB 80MG/1ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES"": ""IXEKIZUMAB"",#(lf)""IXEKIZUMAB(HEALTHCAREATHOME-HOMECARE)"": ""IXEKIZUMAB"",#(lf)""JYSELECA 100MG TABLETS (GILEAD SCIENCES LTD)"": ""JYSELECA"",#(lf)""Jyseleca 200mg tablets (Gilead Sciences Ltd)"": ""Jyseleca"",#(lf)""KAFTRIO"": ""KAFTRIO"",#(lf)""Kyprolis 60mg powder for solution for infusion vials (Amgen Ltd)"": ""Carfilzomib"",#(lf)""LANREOTIDE"": ""LANREOTIDE"",#(lf)""LANREOTIDE!120mg!SYRINGE"": ""LANREOTIDE"",#(lf)""LENALIDOMIDE"": ""LENALIDOMIDE"",#(lf)""lenograstim"": ""lenograstim"",#(lf)""LETERMOVIR"": ""LETERMOVIR"",#(lf)""LEVOSIMENDAN"": ""LEVOSIMENDAN"",#(lf)""LIOTHYRONINE"": ""LIOTHYRONINE"",#(lf)""LPCH (HOMECARE) EMERGENCY DELIVERY FEE"": ""HOMECARE"",#(lf)""LUCENTIS"": ""LUCENTIS"",#(lf)""LUSUTROMBOPAG"": ""LUSUTROMBOPAG"",#(lf)""Lynparza 150mg tablets (AstraZeneca UK Ltd)"": ""Olaparib"",#(lf)""MEPOLIZUMAB"": ""MEPOLIZUMAB"",#(lf)""MEROPENEM"": ""MEROPENEM"",#(lf)""METHOTREXATE"": ""METHOTREXATE"",#(lf)""METHOTREXATE INTRAVITREAL"": ""METHOTREXATE"",#(lf)""METRELEPTIN"": ""METRELEPTIN"",#(lf)""MIRIKIZUMAB"": ""MIRIKIZUMAB"",#(lf)""MITOMYCIN"": ""MITOMYCIN"",#(lf)""MITOMYCIN 40MG POWDER FOR INTRAVESICAL SOLUTION VIALS"": ""MITOMYCIN"",#(lf)""MOLNUPIRAVIR"": ""MOLNUPIRAVIR"",#(lf)""MOLNUPIRAVIR (COVID - F.O.C)"": ""MOLNUPIRAVIR"",#(lf)""MOVYMIA (Homecare) TERIPARATIDE"": ""TERIPARATIDE"",#(lf)""MYCOPHENOLATE MOFETIL"": ""MYCOPHENOLATE"",#(lf)""MYCOPHENOLATE MOFETIL (Cellcept brand)"": ""MOFETIL"",#(lf)""MYCOPHENOLATE MOFETIL 250MG CAPSULES"": ""MYCOPHENOLATE"",#(lf)""MYCOPHENOLATE MOFETIL 500MG TABLETS"": ""MYCOPHENOLATE"",#(lf)""MYCOPHENOLIC ACID"": ""MYCOPHENOLIC"",#(lf)""NEORAL 100MG CAPSULES (NOVARTIS PHARMACEUTICALS UK LTD)"": ""Ciclosporin"",#(lf)""NEORAL 50MG CAPSULES (NOVARTIS PHARMACEUTICALS UK LTD)"": ""Ciclosporin"",#(lf)""Neratinib 40mg tablets"": ""Neratinib"",#(lf)""NERIA (29g/10mm NEEDLE, 60cm TUBING) (HOMECARE - LPCH)"": ""N/A"",#(lf)""NERIA (29g/8mm NEEDLE, 110cm TUBING) (HOMECARE - LPCH)"": ""N/A"",#(lf)""NERIA (29g/8mm NEEDLE, 60cm TUBING) (HOMECARE - LPCH)"": ""N/A"",#(lf)""NERIA 27G/9MM/110CM"": ""N/A"",#(lf)""NERIA 29G/10MM/60CM"": ""N/A"",#(lf)""NERIA 29G/8MM/110CM"": ""N/A"",#(lf)""NERIA 29G/8MM/60CM"": ""N/A"",#(lf)""NERIA 9MM/60CM"": ""N/A"",#(lf)""NERIA GUARD NEEDLE 9MM/60CM"": ""N/A"",#(lf)""NERIA GUARD NEEDLE 9MM/60CM (HOMECARE)"": ""N/A"",#(lf)""NERIA INFUSION SET (27G/8MM NEEDLE, 60CM TUBING)"": ""N/A"",#(lf)""NERIA NEEDLE GUARD 6MM/60CM"": ""N/A"",#(lf)""NERIAGUARD"": ""N/A"",#(lf)""NEUROBLOC"": ""N/A"",#(lf)""Niraparib 100mg capsules"": ""Niraparib"",#(lf)""NIRMATRELVIR and RITONAVIR"": ""NIRMATRELVIR and RITONAVIR"",#(lf)""NORMAL IMMUNOGLOBULIN (PRIVIGEN 10%)"": ""IMMUNOGLOBULIN"",#(lf)""NORMAL IMMUNOGLOBULIN HUMAN"": ""IMMUNOGLOBULIN"",#(lf)""NURSING CHARGE"": ""IMMUNOGLOBULIN"",#(lf)""nusinersen"": ""nusinersen"",#(lf)""NUTROPINAQ 10MG/2ML SOLUTION FOR INJECTION CARTRIDGES (IPSEN LTD)"": ""Somatropin"",#(lf)""OBINUTUZUMAB"": ""OBINUTUZUMAB"",#(lf)""OCRIPLASMIN"": ""OCRIPLASMIN"",#(lf)""OCTREOTIDE"": ""OCTREOTIDE"",#(lf)""Octreotide 20mg powder and solvent for suspension for injection vials"": ""Octreotide"",#(lf)""Octreotide 30mg powder and solvent for suspension for injection vials"": ""Octreotide"",#(lf)""Octreotide 500micrograms/1ml solution for injection vials"": ""Octreotide"",#(lf)""Octreotide 50micrograms/1ml solution for injection ampoules"": ""Octreotide"",#(lf)""OLUMIANT (HOMECARE) BARICITINIB"": ""BARICITINIB"",#(lf)""OLUMIANT 4MG TABLETS (ELI LILLY AND COMPANY LTD)"": ""Baricitinib"",#(lf)""OMALIZUMAB"": ""OMALIZUMAB"",#(lf)""OMALIZUMAB (Xolair)"": ""OMALIZUMAB"",#(lf)""OMALIZUMAB 150MG/1ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES"": ""OMALIZUMAB"",#(lf)""OMNITROPE SUREPAL 10 10MG/1.5ML SOLUTION FOR INJECTION CARTRIDGES (SANDOZ LTD)"": ""Somatropin"",#(lf)""OMNITROPE SUREPAL 15 15MG/1.5ML SOLUTION FOR INJECTION CARTRIDGES (SANDOZ LTD)"": ""Somatropin"",#(lf)""OMNITROPE SUREPAL 5 5MG/1.5ML SOLUTION FOR INJECTION CARTRIDGES (SANDOZ LTD)"": ""Somatropin"",#(lf)""ONC/HAEM HOMECARE 6 MONTHLY DELIVERY CHARGE"": ""HOMECARE"",#(lf)""ONGAVIA"": ""Ranibizumab"",#(lf)""ONGAVIA 2.3MG/0.23ML SOLUTION FOR INJECTION VIALS (TEVA UK LTD)"": ""Ranibizumab"",#(lf)""Orencia 125mg/1ml solution for injection pre-filled syringes (Bristol-Myers Squibb Pharmaceuticals Ltd)"": ""Abatacept"",#(lf)""ORENCIA CLICKJECT 125MG/1ML SOLUTION FOR INJECTION PRE-FILLED PENS (BRISTOL-MYERS SQUIBB PHARMACEUTICALS LTD)"": ""Abatacept"",#(lf)""OTEZLA 30MG TABLETS (AMGEN LTD)"": ""Apremilast"",#(lf)""OXALIPLATIN"": ""OXALIPLATIN"",#(lf)""PACLITAXEL"": ""PACLITAXEL"",#(lf)""Paclitaxel 100mg/16.7ml solution for infusion vials"": ""Paclitaxel"",#(lf)""Paclitaxel 150mg/25ml solution for infusion vials"": ""Paclitaxel"",#(lf)""Paclitaxel 30mg/5ml solution for infusion vials"": ""Paclitaxel"",#(lf)""Paclitaxel albumin 100mg powder for suspension for infusion vials"": ""Paclitaxel"",#(lf)""PALBOCICLIB"": ""PALBOCICLIB"",#(lf)""PALFORZIA INITIAL DOSE ESCALATION"": ""PALFORZIA"",#(lf)""Palforzia Level 1 (3mg daily) 2 week up-dosing pack"": ""PALFORZIA"",#(lf)""PALFORZIA LEVEL 10 (240MG DAILY) 2 WEEK UP-DOSING PACK (AIMMUNE THERAPEUTICS UK LTD)"": ""PALFORZIA"",#(lf)""PALFORZIA LEVEL 11 (300MG DAILY) 2 WEEK UP-DOSING PACK"": ""PALFORZIA"",#(lf)""PALFORZIA LEVEL 11 (300MG DAILY) 2 WEEK UP-DOSING PACK (AIMMUNE THERAPEUTICS UK LTD)"": ""PALFORZIA"",#(lf)""PALFORZIA LEVEL 3 (12MG DAILY) 2 WEEK UP-DOSING PACK (AIMMUNE THERAPEUTICS UK LTD)"": ""PALFORZIA"",#(lf)""PALFORZIA LEVEL 4 (20MG DAILY) 2 WEEK UP-DOSING PACK (AIMMUNE THERAPEUTICS UK LTD)"": ""PALFORZIA"",#(lf)""PALFORZIA LEVEL 6 (80MG DAILY) 2 WEEK UP-DOSING PACK (AIMMUNE THERAPEUTICS UK LTD)"": ""PALFORZIA"",#(lf)""PALFORZIA LEVEL 7 (120MG DAILY) 2 WEEK UP-DOSING PACK (AIMMUNE THERAPEUTICS UK LTD)"": ""PALFORZIA"",#(lf)""PALFORZIA LEVEL 8 (160MG DAILY) 2 WEEK UP-DOSING PACK (AIMMUNE THERAPEUTICS UK LTD)"": ""PALFORZIA"",#(lf)""PALFORZIA LEVEL 9 (200MG DAILY) 2 WEEK UP-DOSING PACK (AIMMUNE THERAPEUTICS UK LTD)"": ""PALFORZIA"",#(lf)""PALFORZIA UP-DOSING LEVEL 1 (3mg DAILY)"": ""PALFORZIA"",#(lf)""PALFORZIA UP-DOSING LEVEL 10 (240MG DAILY)"": ""PALFORZIA"",#(lf)""PALFORZIA UP-DOSING LEVEL 11 (300mg DAILY)"": ""PALFORZIA"",#(lf)""PALFORZIA UP-DOSING LEVEL 2 (6MG DAILY)"": ""PALFORZIA"",#(lf)""PALFORZIA UP-DOSING LEVEL 3 (12MG DAILY)"": ""PALFORZIA"",#(lf)""PALFORZIA UP-DOSING LEVEL 4 (20MG DAILY)"": ""PALFORZIA"",#(lf)""PALFORZIA UP-DOSING LEVEL 5 (40MG DAILY)"": ""PALFORZIA"",#(lf)""PALFORZIA UP-DOSING LEVEL 6 (80MG DAILY)"": ""PALFORZIA"",#(lf)""PALFORZIA UP-DOSING LEVEL 7 (120MG DAILY)"": ""PALFORZIA"",#(lf)""PALFORZIA UP-DOSING LEVEL 8 (160mg DAILY)"": ""PALFORZIA"",#(lf)""PALFORZIA UP-DOSING LEVEL 9 (200mg DAILY)"": ""PALFORZIA"",#(lf)""Palivizumab 50mg/0.5ml solution for injection vials"": ""Palivizumab"",#(lf)""PARENTERAL NUTRITION"": ""PARENTERAL"",#(lf)""PAXLOVID  150MG+100MG TABLETS"": ""PAXLOVID"",#(lf)""PEGINTERFERON ALFA-2a"": ""PEGINTERFERON"",#(lf)""Pertuzumab 600mg/10ml / Trastuzumab 600mg/10ml solution for injection vials"": ""Pertuzumab"",#(lf)""PITOLISANT  18MG TABLETS"": ""Pitolisant"",#(lf)""PITOLISANT  4.5MG TABLETS"": ""N/A"",#(lf)""PROGRAF 5MG/1ML SOLUTION FOR INFUSION AMPOULES (ASTELLAS PHARMA LTD)"": ""TACROLIMUS"",#(lf)""PS (Bathasu) - INFLIXIMAB (INFLECTRA)"": ""INFLIXIMAB"",#(lf)""PS (Quantum) - INFLIXIMAB (INFLECTRA)"": ""INFLIXIMAB"",#(lf)""RANIBIZUMAB"": ""RANIBIZUMAB"",#(lf)""RANIBIZUMAB (0.165ML)"": ""RANIBIZUMAB"",#(lf)""RANIBIZUMAB (Left eye)"": ""RANIBIZUMAB"",#(lf)""RANIBIZUMAB (LUCENTIS)"": ""RANIBIZUMAB"",#(lf)""RANIBIZUMAB (ONGAVIA)"": ""RANIBIZUMAB"",#(lf)""RANIBIZUMAB (ONGAVIA) (0.23ml)"": ""RANIBIZUMAB"",#(lf)""RANIBIZUMAB (Right eye)"": ""RANIBIZUMAB"",#(lf)""RANIBIZUMAB 1.65MG/0.165ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES"": ""RANIBIZUMAB"",#(lf)""RANIBIZUMAB(0.165ML)"": ""RANIBIZUMAB"",#(lf)""RASBURICASE"": ""RASBURICASE"",#(lf)""REMDESIVIR"": ""REMDESIVIR"",#(lf)""REMDESIVIR 100MG POWDER FOR SOLUTION FOR INFUSION VIALS"": ""REMDESIVIR"",#(lf)""REMICADE 100MG POWDER FOR CONCENTRATE FOR SOLUTION FOR INFUSION VIALS (MERCK SHARP & DOHME LTD)"": ""REMICADE"",#(lf)""REMSIMA 100MG POWDER FOR CONCENTRATE FOR SOLUTION FOR INFUSION VIALS (NAPP PHARMACEUTICALS LTD)"": ""INFLIXIMAB"",#(lf)""REPATHA SURECLICK 140MG/1ML SOLUTION FOR INJECTION PRE-FILLED PENS (AMGEN LTD)"": ""Evolocumab"",#(lf)""RILUZOLE"": ""RILUZOLE"",#(lf)""RISANKIZUMAB"": ""RISANKIZUMAB"",#(lf)""RISANKIZUMAB (HOMECARE)"": ""RISANKIZUMAB"",#(lf)""RISANKIZUMAB (SKYRIZI)"": ""RISANKIZUMAB"",#(lf)""RITUXIMAB"": ""RITUXIMAB"",#(lf)""RITUXIMAB - MABTHERA"": ""RITUXIMAB"",#(lf)""RITUXIMAB - RIXATHON"": ""RITUXIMAB"",#(lf)""RITUXIMAB - TRUXIMA"": ""RITUXIMAB"",#(lf)""RITUXIMAB (ASEPTIC) in Sodium Chloride 0.9%"": ""RITUXIMAB"",#(lf)""RITUXIMAB (MABTHERA)"": ""RITUXIMAB"",#(lf)""RITUXIMAB (RIXATHON)"": ""Rituximab"",#(lf)""RITUXIMAB (TRUXIMA)"": ""RITUXIMAB"",#(lf)""Rituximab 100mg/10ml solution for infusion vials"": ""Rituximab"",#(lf)""RITUXIMAB 500MG/50ML SOLUTION FOR INFUSION VIALS"": ""RITUXIMAB"",#(lf)""RIXATHON  500MG/50ML CONCENTRATE FOR SOLUTION FOR INFUSION"": ""RIXATHON"",#(lf)""ROACTEMRA (HOMECARE PEN PACK) TOCILIZUMAB"": ""Tocilizumab"",#(lf)""ROACTEMRA 162MG/0.9ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES (ROCHE PRODUCTS LTD)"": ""Tocilizumab"",#(lf)""ROACTEMRA 200MG/10ML CONCENTRATE FOR SOLUTION FOR INFUSION VIALS (ROCHE PRODUCTS LTD)"": ""Tocilizumab"",#(lf)""ROACTEMRA 400MG/20ML CONCENTRATE FOR SOLUTION FOR INFUSION VIALS (ROCHE PRODUCTS LTD)"": ""Tocilizumab"",#(lf)""ROACTEMRA 80MG/4ML CONCENTRATE FOR SOLUTION FOR INFUSION VIALS (ROCHE PRODUCTS LTD)"": ""Tocilizumab"",#(lf)""ROMIPLOSTIM"": ""ROMIPLOSTIM"",#(lf)""ROMIPLOSTIM (HOMECARE)"": ""ROMIPLOSTIM"",#(lf)""ROMIPLOSTIM 250MICROGRAM POWDER AND SOLVENT FOR SOLUTION FOR INJECTION PRE-FILLED DISPOSABLE DEVICES"": ""ROMIPLOSTIM"",#(lf)""ROMIPLOSTIM 250MICROGRAM POWDER FOR SOLUTION FOR INJECTION VIALS"": ""ROMIPLOSTIM"",#(lf)""ROMOSOZUMAB"": ""ROMOSOZUMAB"",#(lf)""ROXADUSTAT"": ""ROXADUSTAT"",#(lf)""RTA BATCH (Quantum) - INFLIXIMAB (INFLECTRA)"": ""INFLIXIMAB"",#(lf)""SACITUZUMAB"": ""SACITUZUMAB"",#(lf)""SACITUZUMAB GOVITECAN 180MG POWDER FOR SOLUTION FOR INFUSION VIALS"": ""SACITUZUMAB"",#(lf)""SAIZEN 12MG/1.5ML SOLUTION FOR INJECTION CARTRIDGES (MERCK SERONO LTD)"": ""Somatropin"",#(lf)""SARILUMAB"": ""SARILUMAB"",#(lf)""SARILUMAB (HOMECARE)"": ""SARILUMAB"",#(lf)""SARILUMAB (Kevzara FOR HOMECARE THERAPY)"": ""SARILUMAB"",#(lf)""SCIENSUS (HOMECARE) 12 WEEKLY DELIVERY FEE"": ""HOMECARE"",#(lf)""SCIENSUS (HOMECARE) 4/8 WEEKLY DELIVERY FEE"": ""HOMECARE"",#(lf)""SCIENSUS (HOMECARE) EMERGENCY DELIVERY FEE"": ""HOMECARE"",#(lf)""SECUKINUMAB"": ""SECUKINUMAB"",#(lf)""SECUKINUMAB  300MG/2ML SOLUTION FOR INJECTION PRE-FILLED DEVICE"": ""SECUKINUMAB"",#(lf)""SECUKINUMAB (Cosentyx FOR HOMECARE THERAPY) Senosready Pen"": ""SECUKINUMAB"",#(lf)""SECUKINUMAB (Cosentyx HOMECARE)"": ""SECUKINUMAB"",#(lf)""SECUKINUMAB (Cosentyx Sensoready HOMECARE)"": ""SECUKINUMAB"",#(lf)""SECUKINUMAB (HOME DELIVERY)"": ""SECUKINUMAB"",#(lf)""SECUKINUMAB (HOMECARE - LPCH) SensoReady SYRINGE"": ""SECUKINUMAB"",#(lf)""SECUKINUMAB (HOMECARE)"": ""SECUKINUMAB"",#(lf)""SECUKINUMAB (HOMECARE) SENSOREADY PEN"": ""SECUKINUMAB"",#(lf)""SECUKINUMAB (HOMECARE) SENSOREADY SYRINGE"": ""SECUKINUMAB"",#(lf)""SECUKINUMAB 150MG/1ML SOLUTION FOR INJECTION PRE-FILLED DISPOSABLE DEVICES"": ""SECUKINUMAB"",#(lf)""SECUKINUMAB 150MG/1ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES"": ""SECUKINUMAB"",#(lf)""SECUKINUMAB 300MG/2ML SOLUTION FOR INJECTION PRE-FILLED DISPOSABLE DEVICES"": ""SECUKINUMAB"",#(lf)""SECUKINUMAB(HOMECARE)SENSOREADYPEN"": ""SECUKINUMAB"",#(lf)""Service Charge"": ""Service"",#(lf)""Service Charge East of England (Standard Ambient)"": ""Charge"",#(lf)""SERVICE COST (DESFERRIOXAMINE)"": ""COST"",#(lf)""SERVICE COST (HEALTHCARE AT HOME)"": ""COST"",#(lf)""SERVICE COST (SCIENSUS - HOMECARE)"": ""HOMECARE"",#(lf)""SERVICE COST (SCIENSUS)"": ""SERVICE"",#(lf)""SEVELAMER"": ""SEVELAMER"",#(lf)""SILDENAFIL"": ""SILDENAFIL"",#(lf)""SIMPONI 100MG/1ML SOLUTION FOR INJECTION PRE-FILLED PENS (MERCK SHARP & DOHME LTD)"": ""SIMPONI"",#(lf)""SIMPONI 50MG/0.5ML SOLUTION FOR INJECTION PRE-FILLED PENS (MERCK SHARP & DOHME LTD)"": ""SIMPONI"",#(lf)""SIROLIMUS"": ""SIROLIMUS"",#(lf)""SKYRIZI (RISANKIZUMAB)"": ""RISANKIZUMAB"",#(lf)""SKYRIZI (RISANKIZUMAB) (HOMECARE)"": ""RISANKIZUMAB"",#(lf)""sodium chloride"": ""Sodium chloride"",#(lf)""SODIUM OXYBATE"": ""SODIUM OXYBATE"",#(lf)""SOLRIAMFETOL"": ""SOLRIAMFETOL"",#(lf)""SOMACORRECT PUMP ( IMHS ORDER CODE 15080 )"": ""MISC"",#(lf)""SOMACORRECT XT PUMP ( IMHS ORDER CODE 15111 )"": ""N/A"",#(lf)""SOMAERECT RESPONSE II vacuum pump (15019)"": ""N/A"",#(lf)""SOMATROGON"": ""SOMATROGON"",#(lf)""SOMATROPIN"": ""SOMATROPIN"",#(lf)""SOMATROPIN (EPR) 10MG/1.5ML SOLUTION FOR INJECTION PRE-FILLED DISPOSABLE DEVICES"": ""SOMATROPIN"",#(lf)""Somatropin (epr) 15mg/1.5ml solution for injection pre-filled disposable devices"": ""Somatropin"",#(lf)""SOMATROPIN (EPR) 5MG/1.5ML SOLUTION FOR INJECTION PRE-FILLED DISPOSABLE DEVICE"": ""SOMATROPIN"",#(lf)""SOMATROPIN (EPR) 5MG/1.5ML SOLUTION FOR INJECTION PRE-FILLED DISPOSABLE DEVICES"": ""SOMATROPIN"",#(lf)""SOMATROPIN (FOR HOMECARE THERAPY) - Genotropin"": ""SOMATROPIN"",#(lf)""SOMATROPIN (GENOTROPIN GO-QUICK)"": ""Somatropin"",#(lf)""SOMATROPIN (GENOTROPIN GO-QUICK) (HOMECARE )"": ""SOMATROPIN"",#(lf)""SOMATROPIN (GENOTROPIN GOQUICK) (HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (GENOTROPIN GO-QUICK) (HOMECARE)"": ""Somatropin"",#(lf)""SOMATROPIN (GENOTROPIN MINIQUICK)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (GENOTROPIN MINIQUICK) (HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (GENOTROPIN MINI-QUICK) (HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (GENOTROPIN MINI-QUICK) HOMECARE"": ""Somatropin"",#(lf)""SOMATROPIN (GENOTROPIN)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (GENOTROPIN) (HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (HUMATROPE) (HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (HUMATROPE) 24mg (HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (HUMOTROPE) 12mg (HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (NORDIFLEX PEN) (HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (NORDITROPIN FLEXPRO PEN) (HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (NORDITROPIN FLEXPRO) (HOMECARE)"": ""NORDITROPIN"",#(lf)""SOMATROPIN (NORDITROPIN NORDIFLEX) (HOMECARE)"": ""NORDITROPIN"",#(lf)""SOMATROPIN (NORDITROPIN SIMPLEXx PEN) (HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (NORDITROPIN SIMPLEXX)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (NORDITROPIN SIMPLEXx) (HEALTHCARE AT HOME)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (NORDITROPIN SIMPLEXx) (HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (NORDITROPIN)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (NUTROPIN AQ)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (NUTROPIN AQ) (HOMECARE - LPCH)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (NUTROPIN AQ) (HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (NUTROPINAQ) (HOMECARE)"": ""Somatropin"",#(lf)""SOMATROPIN (NUTROPINAQ) (rbe) injection 30 units (HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (OMNITROPE - SUREPAL) (HEALTHCARE@HOME)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (OMNITROPE SUREPAL 1.1ml) (HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (OMNITROPE SUREPAL 1.5ML) (HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (OMNITROPE SUREPAL) (HEALTHCARE@HOME)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (OMNITROPE SUREPAL) (HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (OMNITROPE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (OMNITROPE) (HOMECARE)"": ""OMNITROPE"",#(lf)""SOMATROPIN (RBE) (OMNITROPE) (HOME DEL)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (RBE) (OMNITROPE) (HOME DEL) (G-S)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (SAIZEN SOLUTION) (HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (SAIZEN)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (SAIZEN) (HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN (ZOMACTON) (HOMECARE)"": ""ZOMACTON"",#(lf)""SOMATROPIN(GENOTROPIN)(HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN(NORDITROPINSIMPLEXX)(HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN(NUTROPINAQ)(HOMECARE)"": ""SOMATROPIN"",#(lf)""SOMATROPIN(OMNITROPESUREPAL)(HOMECARE)"": ""SOMATROPIN"",#(lf)""somatropin"": ""SOMATROPIN"",#(lf)""SOTROVIMAB"": ""SOTROVIMAB"",#(lf)""SOTROVIMAB 500MG/8ML SOLUTION FOR INFUSION VIALS"": ""SOTROVIMAB"",#(lf)""SOTROVIMAB VIAL"": ""SOTROVIMAB"",#(lf)""Standard ERT Oral Service Charge"": ""N/A"",#(lf)""STELARA 130MG/26ML CONCENTRATE FOR SOLUTION FOR INFUSION VIALS (JANSSEN-CILAG LTD)"": ""Ustekinumab"",#(lf)""STELARA 45MG/0.5ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES (JANSSEN-CILAG LTD)"": ""Ustekinumab"",#(lf)""STELARA 45MG/0.5ML SOLUTION FOR INJECTION VIALS (JANSSEN-CILAG LTD)"": ""Ustekinumab"",#(lf)""STELARA 90MG/1ML SOLUTION FOR INJECTION PRE-FILLED SYRINGES (JANSSEN-CILAG LTD)"": ""Ustekinumab"",#(lf)""STIRIPENTOL"": ""STIRIPENTOL"",#(lf)""STIRIPENTOL (HOMECARE)"": ""STIRIPENTOL"",#(lf)""STIRIPENTOL 500MG CAPSULES"": ""STIRIPENTOL"",#(lf)""TACROLIMUS"": ""TACROLIMUS"",#(lf)""TACROLIMUS (Advagraf)"": ""TACROLIMUS"",#(lf)""TACROLIMUS 1MG CAPSULES"": ""TACROLIMUS"",#(lf)""TACROLIMUS 1MG MODIFIED-RELEASE CAPSULES"": ""TACROLIMUS"",#(lf)""TACROLIMUS 5MG MODIFIED-RELEASE CAPSULES"": ""TACROLIMUS"",#(lf)""TACROLIMUS MONOHYDRATE"": ""TACROLIMUS"",#(lf)""Targretin 75mg capsules (Eisai Ltd)"": ""Bexarotene"",#(lf)""Tecentriq 1200mg/20ml concentrate for solution for infusion vials (Roche Products Ltd)"": ""Atezolizumab"",#(lf)""Tecentriq 840mg/14ml concentrate for solution for infusion vials (Roche Products Ltd)"": ""Atezolizumab"",#(lf)""TEMOZOLOMIDE"": ""TEMOZOLOMIDE"",#(lf)""TERIPARATIDE"": ""TERIPARATIDE"",#(lf)""TERIPARATIDE - FORSTEO  (HOMECARE)"": ""TERIPARATIDE"",#(lf)""TERIPARATIDE - TERROSA  (HOMECARE)"": ""TERIPARATIDE"",#(lf)""TERIPARATIDE (FOR HOMECARE THERAPY)"": ""TERIPARATIDE"",#(lf)""TERIPARATIDE (Forsteo)"": ""TERIPARATIDE"",#(lf)""TERIPARATIDE (homecare)"": ""TERIPARATIDE"",#(lf)""TERIPARATIDE (Movymia HOMECARE)"": ""TERIPARATIDE"",#(lf)""TERIPARATIDE-FORSTEO(HOMECARE)"": ""TERIPARATIDE"",#(lf)""TERIPARATIDE-TERROSA(HOMECARE)"": ""TERIPARATIDE"",#(lf)""Terrosa"": ""TERIPARATIDE"",#(lf)""TERROSA (Homecare) TERIPARATIDE"": ""TERIPARATIDE"",#(lf)""Terrosa 20micrograms/80microlitres solution for injection 2.4ml cartridge (Gedeon Richter (UK) Ltd)"": ""Teriparatide"",#(lf)""TILDRAKIZUMAB"": ""TILDRAKIZUMAB"",#(lf)""TILDRAKIZUMAB (FOR HOMECARE THERAPY)"": ""TILDRAKIZUMAB"",#(lf)""TILDRAKIZUMAB (HOMECARE)"": ""TILDRAKIZUMAB"",#(lf)""TILDRAKIZUMAB 100mg DOSE PACK (HOMECARE)"": ""TILDRAKIZUMAB"",#(lf)""TILDRAKIZUMAB 200mg DOSE PACK (HOMECARE)"": ""TILDRAKIZUMAB"",#(lf)""TOBRAMYCIN"": ""TOBRAMYCIN"",#(lf)""TOCILIZUMAB"": ""TOCILIZUMAB"",#(lf)""TOCILIZUMAB  200MG/10ML CONCENTRATE FOR SOLUTION FOR INFUSION"": ""TOCILIZUMAB"",#(lf)""TOCILIZUMAB  400MG/20ML CONCENTRATE FOR SOLUTION FOR INFUSION"": ""TOCILIZUMAB"",#(lf)""TOCILIZUMAB - ROACTEMRA"": ""TOCILIZUMAB"",#(lf)""TOCILIZUMAB - ROACTEMRA (HOMECARE)"": ""TOCILIZUMAB"",#(lf)""TOCILIZUMAB (Covid-19)"": ""TOCILIZUMAB"",#(lf)""TOCILIZUMAB (for COVID treatment only)"": ""TOCILIZUMAB"",#(lf)""TOCILIZUMAB (HOME DELIVERY)"": ""TOCILIZUMAB"",#(lf)""TOCILIZUMAB (HOME DELIVERY) (G-S)"": ""TOCILIZUMAB"",#(lf)""TOCILIZUMAB (Homecare - RoActemra)"": ""TOCILIZUMAB"",#(lf)""TOCILIZUMAB (homecare)"": ""TOCILIZUMAB"",#(lf)""TOCILIZUMAB (homecare) PEN"": ""TOCILIZUMAB"",#(lf)""TOCILIZUMAB (P)"": ""TOCILIZUMAB"",#(lf)""TOCILIZUMAB (RoActemra FOR HOMECARE THERAPY)"": ""TOCILIZUMAB"",#(lf)""TOCILIZUMAB (Ro-Actemra)"": ""TOCILIZUMAB"",#(lf)""TOCILIZUMAB!162mg/0.9mL!PRE-FILLED"": ""TOCILIZUMAB"",#(lf)""TOCILIZUMAB-ROACTEMRA"": ""TOCILIZUMAB"",#(lf)""TOFACITINIB"": ""TOFACITINIB"",#(lf)""TOFACITINIB (FOR HOMECARE THERAPY)"": ""TOFACITINIB"",#(lf)""TOFACITINIB (HOMECARE - PAS - NICE TA547)"": ""TOFACITINIB"",#(lf)""TOFACITINIB (HOMECARE)"": ""TOFACITINIB"",#(lf)""Tofacitinib 10mg tablets"": ""Tofacitinib"",#(lf)""TOFACITINIB 5MG TABLETS"": ""TOFACITINIB"",#(lf)""TOFACITINIB(HOMECARE)"": ""TOFACITINIB"",#(lf)""TOFACTINIB (HOMECARE)"": ""TOFACITINIB"",#(lf)""TOLVAPTAN"": ""TOLVAPTAN"",#(lf)""TOLVAPTAN (JINARC)"": ""TOLVAPTAN"",#(lf)""TOLVAPTAN (JINARC) (HOMECARE) 90mg/30mg"": ""TOLVAPTAN"",#(lf)""TOLVAPTAN (JINARC) 45mg/15mg"": ""TOLVAPTAN"",#(lf)""TOLVAPTAN (JINARC) 60mg/30mg"": ""TOLVAPTAN"",#(lf)""TOLVAPTAN (JINARC) 90mg/30mg"": ""TOLVAPTAN"",#(lf)""TOLVAPTAN (Samsca)"": ""TOLVAPTAN"",#(lf)""TOLVAPTAN (TEVA)"": ""TOLVAPTAN"",#(lf)""TOLVAPTAN (TEVA) (HOMECARE)"": ""TOLVAPTAN"",#(lf)""TOLVAPTAN (TEVA) 45mg/15mg"": ""TOLVAPTAN"",#(lf)""TOLVAPTAN (TEVA) 60mg/30mg"": ""TOLVAPTAN"",#(lf)""TOLVAPTAN (TEVA) 90mg/30mg"": ""TOLVAPTAN"",#(lf)""TRALOKINUMAB"": ""v"",#(lf)""TRASTUZUMAB (SUBCUTANEOUS)"": ""TRASTUZUMAB"",#(lf)""TRIAL-PIONEERLASMIDITANKITS(VARIOUS)"": ""N/A"",#(lf)""TRIOMEL 7G/LITRE NITROGEN 1140KCAL/LITRE WITH ELECTROLYTES INFUSION 2LITRE BAGS (BAXTER HEALTHCARE LTD)"": ""misc"",#(lf)""TRUXIMA (Rituximab)"": ""TRUXIMA"",#(lf)""TRUXIMA 500MG/50ML CONCENTRATE FOR SOLUTION FOR INFUSION VIALS (NAPP PHARMACEUTICALS LTD)"": ""RITUXIMAB"",#(lf)""ULTIMATE SUREFIT RING (15222)"": ""N/A"",#(lf)""UPADACITINIB"": ""UPADACITINIB"",#(lf)""UPADACITINIB (HOMECARE)"": ""UPADACITINIB"",#(lf)""UPADACITINIB (HOMECARE)(1GBP CFA)"": ""HOMECARE"",#(lf)""UPADACITINIB (Rinvoq HOMECARE)"": ""UPADACITINIB"",#(lf)""UPADACITINIB 15MG MODIFIED-RELEASE TABLETS"": ""UPADACITINIB"",#(lf)""UPADACITINIB 30mg"": ""UPADACITINIB"",#(lf)""UPADACITINIB 45mg"": ""UPADACITINIB"",#(lf)""UPADACITINIB 45MG MODIFIED-RELEASE TABLETS"": ""UPADACITINIB"",#(lf)""UPADACITINIB(HOMECARE)"": ""UPADACITINIB"",#(lf)""USTEKINUMAB"": ""USTEKINUMAB"",#(lf)""USTEKINUMAB - STELARA"": ""USTEKINUMAB"",#(lf)""USTEKINUMAB - STELARA (HOMECARE - LLOYDS)"": ""USTEKINUMAB"",#(lf)""USTEKINUMAB - STELARA (HOMECARE)"": ""USTEKINUMAB"",#(lf)""USTEKINUMAB (homecare)"": ""USTEKINUMAB"",#(lf)""USTEKINUMAB (Stelara FOR HOMECARE THERAPY)"": ""USTEKINUMAB"",#(lf)""USTEKINUMAB-STELARA"": ""USTEKINUMAB"",#(lf)""USTEKINUMAB-STELARA(HOMECARE)"": ""USTEKINUMAB"",#(lf)""USTEKINUMAB-STELARA(HOMECARE-LLOYDS)"": ""USTEKINUMAB"",#(lf)""VABYSMO"": ""FARICIMAB"",#(lf)""VANCOMYCIN"": ""VANCOMYCIN"",#(lf)""Vanquoral 100mg capsules (Teva UK Ltd)"": ""Ciclosporin"",#(lf)""Vanquoral 25mg capsules (Teva UK Ltd)"": ""Ciclosporin"",#(lf)""VANQUORAL 50MG CAPSULES (TEVA UK LTD)"": ""Ciclosporin"",#(lf)""VEDOLIZUMAB"": ""VEDOLIZUMAB"",#(lf)""VEDOLIZUMAB  300MG POWDER FOR CONCENTRATE FOR SOLUTION DOSES 1 TO 3"": ""VEDOLIZUMAB"",#(lf)""VEDOLIZUMAB (Entyvio)"": ""VEDOLIZUMAB"",#(lf)""VEDOLIZUMAB (HOME DELIVERY)"": ""VEDOLIZUMAB"",#(lf)""VEDOLIZUMAB (HOMECARE PEN PACK) ENTYVIO"": ""VEDOLIZUMAB"",#(lf)""VEDOLIZUMAB (HOMECARE)"": ""VEDOLIZUMAB"",#(lf)""VEDOLIZUMAB 108MG/0.68ML SOLUTION FOR INJECTION PRE-FILLED DISPOSABLE DEVICES"": ""VEDOLIZUMAB"",#(lf)""Vedolizumab 300mg powder for solution for infusion vials"": ""Vedolizumab"",#(lf)""VERTEPORFIN"": ""VERTEPORFIN"",#(lf)""VINBLASTINE 10MG/10ML SOLUTION FOR INJECTION VIALS"": ""VINBLASTINE"",#(lf)""VINCRISTINE"": ""VINCRISTINE"",#(lf)""VISMODEGIB"": ""VISMODEGIB"",#(lf)""VORICONAZOLE"": ""VORICONAZOLE"",#(lf)""Voriconazole 200mg powder and solvent for solution for infusion vials"": ""Voriconazole"",#(lf)""XELJANZ (TOFACTINIB) (HOMECARE)"": ""TOFACITINIB"",#(lf)""XEOMIN  100UNIT POWDER FOR SOLUTION FOR INJECTION"": ""XEOMIN  "",#(lf)""XEOMIN  100UNIT POWDER FOR SOLUTION FOR INJECTION (G-S)"": ""XEOMIN  "",#(lf)""Zanubrutinib 80mg capsules"": ""Zanubrutinib"",#(lf)""Zejula 100mg capsules (GlaxoSmithKline UK Ltd)"": ""Niraparib"",#(lf)""ZZZAFLIBERCEPT intravitreal (Left eye)"": ""AFLIBERCEPT"",#(lf)""ZZZAFLIBERCEPT intravitreal (Right eye)"": ""AFLIBERCEPT"",#(lf)""BIMEKIZUMAB (Bimzelx) FOR HOMECARE THERAPY"": ""BIMEKIZUMAB"",#(lf)""ROACTEMRA (HOMECARE SYRINGE PACK) TOCILIZUMAB"": ""TOCILIZUMAB"",#(lf)""PALFORZIA LEVEL 7 (120MG DAILY) 2 WEEK UP-DOSING PACK"": ""Palforzia"",#(lf)""PALFORZIA LEVEL 6 (80MG DAILY) 2 WEEK UP-DOSING PACK"": ""Palforzia""}#(lf)dataset['Drug Name'] = dataset['Drug Name'].map(drug_dict)#(lf)cleaned_df = dataset.copy()#(lf)cleaned_df = cleaned_df[#(lf)        (cleaned_df['Drug Name'] != 'N/A') & #(lf)        (cleaned_df['Drug Name'].notna()) & #(lf)        (cleaned_df['Drug Name'] != '')#(lf)    ]#(lf)dataset = cleaned_df.copy()",[dataset=dataset]),
    dataset1 = #"Rename Drug Name"{[Name="dataset"]}[Value],
    #"Changed Type" = Table.TransformColumnTypes(dataset1,{{"Drug Name", type text}, {"Provider Code", type text}, {"OrganisationName", type text}, {"PersonKey", type text}, {"indication", type text}, {"Treatment Function Code", type text}, {"Additional Detail 1", type text}, {"Additional Detail 2", type text}, {"Additional Detail 3", type text}, {"Additional Detail 4", type text}, {"Additional Detail 5", type text}, {"Additional Description 1", type text}, {"Additional Description 2", type text}, {"Additional Description 3", type text}, {"Additional Description 4", type text}, {"Additional Description 5", type text}, {"NCDR Treatment Function Name", type text}, {"Treatment Function Desc", type text}, {"Intervention Date", type datetime}, {"Price Actual", type number}, {"Directory", type text}}),
    #"Run Python script1" = Python.Execute("from collections import Counter#(lf)import numpy as np#(lf)import pandas as pd#(lf)#(lf)#(lf)def human_format(num):#(lf)    num = float('{:.3g}'.format(num))#(lf)    magnitude = 0#(lf)    while abs(num) >= 1000:#(lf)        magnitude += 1#(lf)        num /= 1000.0#(lf)    return '{}{}'.format('{:f}'.format(num).rstrip('0').rstrip('.'), ['', 'K', 'M', 'B', 'T'][magnitude])#(lf)#(lf)def drop_duplicate_treatments(dataset, ascending):#(lf)    # Create a copy to avoid modifying the original#(lf)    df = dataset.copy()#(lf)    df = df.sort_values(by=['Intervention Date'], ascending=ascending)#(lf)    dataset_treatment_steps = df.drop_duplicates(subset=""PersonKeyTreatment"", keep=""first"")#(lf)    if not ascending:#(lf)        dataset_treatment_steps = dataset_treatment_steps.sort_values(by=['Intervention Date'], ascending=True)#(lf)    return dataset_treatment_steps#(lf)#(lf)def row_function(row):#(lf)    ids = """"#(lf)    parents = ""N&WICS""#(lf)    values = row.values#(lf)    count = len(values)#(lf)    last_valid_value = None#(lf)    #(lf)    for c in range(count):#(lf)        v = values[c]#(lf)        if pd.isna(v) or v is None:  # Handle None/NaN values#(lf)            continue#(lf)            #(lf)        v_str = str(v)#(lf)        if v_str.strip():  # Only update if we have a non-empty string#(lf)            last_valid_value = v_str#(lf)            if c == count - 1:#(lf)                ids = parents + "" - "" + v_str#(lf)                continue#(lf)            parents += "" - "" + v_str#(lf)    #(lf)    if last_valid_value is None:#(lf)        # Fallback if we somehow got no valid values#(lf)        return ""N&WICS,NO_LABEL,N&WICS""#(lf)        #(lf)    value = parents + "","" + last_valid_value + "","" + (ids or parents + "" - "" + last_valid_value)#(lf)    return value#(lf)#(lf)def count_list_values(x):#(lf)    return list(Counter(sorted(x)).values())#(lf)#(lf)def sum_list_values(x):#(lf)    sum_list = []#(lf)    for count in range(len(x[""Drug Name""])):#(lf)        if count == 0:#(lf)            sum_list.append(sum(x[""Price Actual""][ : x[""Drug Name""][count]]))#(lf)        else:#(lf)            sum_list.append(sum(x[""Price Actual""][x[""Drug Name""][count-1] : (x[""Drug Name""][count-1] + x[""Drug Name""][count])]))#(lf)    return sum_list#(lf)#(lf)def remove_nan_string(y):#(lf)    return [x for x in y if str(x) != 'nan']#(lf)#(lf)def min_max_treatment_dates(ice_dataset, row):#(lf)    ids = row.iloc[2] if isinstance(row, pd.Series) else row[2]#(lf)    min_max = ice_dataset[ice_dataset[""ids""].str.contains(ids)]#(lf)    min_date = str(min_max[""First seen""].min().strftime('%Y-%m-%d'))#(lf)    max_date = str(min_max[""Last seen""].max().strftime('%Y-%m-%d'))#(lf)    return min_date + ',' + max_date#(lf)#(lf)def start_date_drug(dataset, x):#(lf)    # Replace None with null#(lf)    x = x.apply(lambda y: y if y is not None else np.nan)#(lf)    drug_count = x.notna().sum()#(lf)    date_string = []#(lf)    for d in range(drug_count):#(lf)        PersonKey_date_var = str(x.name) + str(x.iloc[d])#(lf)        date = dataset.loc[PersonKey_date_var, ""Intervention Date""]#(lf)        date_string.append(date)#(lf)    return date_string#(lf)#(lf)def end_date_drug(dataset, x):#(lf)    x = x.apply(lambda y: y if y is not None else np.nan)#(lf)    drug_count = x.notna().sum()#(lf)    date_string = []#(lf)    # Need to -1 from drug count as start date gets counted from notnull above#(lf)    for d in range(drug_count - 1):#(lf)        PersonKey_date_var = str(x.name) + str(x.iloc[d])#(lf)        date = dataset.loc[PersonKey_date_var, ""Intervention Date""]#(lf)        date_string.append(date)#(lf)    return date_string#(lf)#(lf)def list_to_string(x):#(lf)    list = x.ids.split(' - ')#(lf)    drug_list = list[len(list) - len(x.average_cost):]#(lf)    ret_string = """"#(lf)    for y in range(len(x.average_cost)):#(lf)        if (round(x.average_spacing[y], 0) > 1) and (round(x.average_administered[y], 0) > 2.5) and (int(x.value) > 0):#(lf)            string = ""<br><b>"" + str(drug_list[y]) + ""</b><br>On average given "" + str(#(lf)                round(x.average_administered[y], 1)) + \#(lf)                     "" times with a "" + str(round(int(x.average_spacing[y]) / 7, 1)) + "" weekly interval ("" \#(lf)                     + str(round((int(x.average_spacing[y]) / 7) * round(x.average_administered[y], 1),#(lf)                                 0)) + "" weeks total treatment length)"" \#(lf)                     ""<br>Average annual cost per annum:"" + \#(lf)                     str(human_format(#(lf)                         (x.cost / x.value) / (((int(x.average_spacing[y]) / 7) * round(x.average_administered[y], 1))/ 52)#(lf)                     ))#(lf)        else:#(lf)            string = ""<br><b>"" + str(drug_list[y]) + ""</b><br>On average given "" + str(#(lf)                round(x.average_administered[y], 1)) + \#(lf)                     "" times with a "" + str(round(int(x.average_spacing[y]) / 7, 1)) + "" weekly interval ("" \#(lf)                     + str(round((int(x.average_spacing[y]) / 7) * round(x.average_administered[y], 1),#(lf)                                 0)) + "" weeks total treatment length)"" \#(lf)                     ""<br>Average annual cost per annum unavailable""#(lf)#(lf)        ret_string += string#(lf)#(lf)    return ret_string#(lf)#(lf)def drug_frequency_average(x):#(lf)    drug_count = x.index.str.contains(""drug_"").sum()#(lf)    freq = []#(lf)    for d in range(drug_count):#(lf)        if x[""freq_"" + str(d)] > 1:#(lf)            duration = ((x[""end_date_"" + str(d)] - x[""start_date_"" + str(d)]) / np.timedelta64(1, 'D'))#(lf)            if duration > 0:#(lf)                freq_calc = duration / (x[""freq_"" + str(d)] - 1)#(lf)            else:#(lf)                freq_calc = 0#(lf)        else:#(lf)            freq_calc = 0#(lf)        freq.append(freq_calc)#(lf)    return freq#(lf)#(lf)def cost_pp_pa(x):#(lf)    if x[""avg_days""]/ np.timedelta64(1, 'D') > 0:#(lf)        return str(round(x[""costpp""] / ((x[""avg_days""] / np.timedelta64(1, 'D')) / 365), 2))#(lf)    else:#(lf)        return ""N/A""#(lf)#(lf)#(lf)#(lf)# Create a copy of the dataset before making modifications#(lf)#dataset = pd.read_csv(r""C:\Users\charlwoodand\PowerBI\HCD.csv"")#(lf)#(lf)dataset = dataset.astype({#(lf)    'Drug Name': str,#(lf)    'Provider Code': str,#(lf)    'OrganisationName': str,#(lf)    'PersonKey': str,#(lf)    'indication': str,#(lf)    'Treatment Function Code': str,#(lf)    'Additional Detail 1': str,#(lf)    'Additional Detail 2': str,#(lf)    'Additional Detail 3': str,#(lf)    'Additional Detail 4': str,#(lf)    'Additional Detail 5': str,#(lf)    'Additional Description 1': str,#(lf)    'Additional Description 2': str,#(lf)    'Additional Description 3': str,#(lf)    'Additional Description 4': str,#(lf)    'Additional Description 5': str,#(lf)    'NCDR Treatment Function Name': str,#(lf)    'Treatment Function Desc': str,#(lf)    'Price Actual': float,#(lf)    'Directory': str#(lf)})#(lf)#(lf)# For the datetime column, use pd.to_datetime#(lf)dataset['Intervention Date'] = pd.to_datetime(dataset['Intervention Date'])#(lf)#(lf)dataset['OrganisationName'] = dataset['OrganisationName'].str.replace(',', '')#(lf)dataset['Drug Name'] = dataset['Drug Name'].str.replace(',', '')#(lf)#(lf)dataset = dataset.dropna(subset=['Intervention Date'])#(lf)#(lf)dataset[""PersonKeyTreatment""] = dataset[""PersonKey""] + dataset[""Drug Name""]#(lf)#(lf)# Find total cost for each patient#(lf)cost_dataset = dataset[[""PersonKey"", ""Price Actual""]]#(lf)total_costs = pd.DataFrame(cost_dataset.groupby(""PersonKey"").sum())#(lf)total_costs = total_costs.rename(columns={""Price Actual"": ""Total cost""})#(lf)#(lf)# Series to map directory#(lf)directory_dataset = dataset[[""PersonKey"", ""Directory""]].drop_duplicates(""PersonKey"").set_index(""PersonKey"")#(lf)trust_dataset = dataset[[""PersonKey"", ""OrganisationName""]].drop_duplicates(""PersonKey"").set_index(""PersonKey"")#(lf)#(lf)print(""Filtering unrelated interventions"")#(lf)#(lf)dataset_end_dates = drop_duplicate_treatments(dataset, False)#(lf)dataset_unique = drop_duplicate_treatments(dataset, True)#(lf)print(""Identifying unique patients and interventions used"")#(lf)#(lf)# Create list of total number of that drug for each patient#(lf)dataset_drug_freq = dataset.groupby(""PersonKey"").agg({""Drug Name"": lambda x: list(x)}).reset_index().set_index(""PersonKey"")#(lf)dataset_drug_cost = dataset.groupby(""PersonKey"").agg({""Price Actual"": lambda x: list(x)}).reset_index().set_index(""PersonKey"")#(lf)#(lf)# Create a copy before making modifications#(lf)dataset_drug_freq = dataset_drug_freq.copy()#(lf)dataset_drug_freq[""Price Actual""] = dataset_drug_freq.index.map(dataset_drug_cost[""Price Actual""])#(lf)dataset_drug_freq[""Drug Name""] = dataset_drug_freq[""Drug Name""].apply(count_list_values)#(lf)dataset_drug_freq[""Drug cost total""] = dataset_drug_freq.apply(lambda x: sum_list_values(x), axis=1)#(lf)#(lf)# Aggregate interventions & dates of interventions into transposed list by PersonKey#(lf)dataset_drugs = dataset_unique.groupby(""PersonKey"").agg({""Drug Name"": lambda x: list(x)}).reset_index().set_index(""PersonKey"")#(lf)dataset_dates = dataset_unique.groupby(""PersonKey"").agg({""Intervention Date"": lambda x: list(x)}).reset_index().set_index(""PersonKey"")#(lf)dataset_end_dates = dataset_end_dates.groupby(""PersonKey"").agg({""Intervention Date"": lambda x: list(x)}).reset_index().set_index(""PersonKey"")#(lf)#(lf)print(""Calculating each unique patient's intervention average frequency, cost and duration of each intervention"")#(lf)#(lf)dataset_dates_unwrapped = pd.DataFrame(dataset_dates[""Intervention Date""].values.tolist(), index=dataset_dates.index).add_prefix('date_')#(lf)dataset_end_dates_unwrapped = pd.DataFrame(dataset_end_dates[""Intervention Date""].values.tolist(), index=dataset_end_dates.index).add_prefix('date_end_')#(lf)dataset_drugs_unwrapped = pd.DataFrame(dataset_drugs[""Drug Name""].values.tolist(), index=dataset_drugs.index).add_prefix('drug_')#(lf)dataset_freq_unwrapped = pd.DataFrame(dataset_drug_freq[""Drug Name""].values.tolist(), index=dataset_drug_freq.index).add_prefix('freq_')#(lf)#(lf)# Create copies before sorting#(lf)start_dates_df = dataset[[""PersonKeyTreatment"", ""Intervention Date""]].copy()#(lf)end_dates_df = dataset[[""PersonKeyTreatment"", ""Intervention Date""]].copy()#(lf)#(lf)start_dates = start_dates_df.sort_values(by=[""Intervention Date""]).drop_duplicates(subset=""PersonKeyTreatment"").set_index(""PersonKeyTreatment"")#(lf)end_dates = end_dates_df.sort_values(by=[""Intervention Date""], ascending=False).drop_duplicates(subset=""PersonKeyTreatment"").set_index(""PersonKeyTreatment"")#(lf)#(lf)# Create a copy before modifications#(lf)dataset_drugs_unwrapped = dataset_drugs_unwrapped.copy()#(lf)#(lf)dataset_drugs_unwrapped[""start_dates""] = dataset_drugs_unwrapped.apply(lambda x: start_date_drug(start_dates, x), axis=1)#(lf)dataset_ddrugs_unwrapped = pd.DataFrame(dataset_drugs_unwrapped[""start_dates""].values.tolist(), index=dataset_drugs_unwrapped.index).add_prefix('start_date_')#(lf)#(lf)dataset_drugs_unwrapped[""end_dates""] = dataset_drugs_unwrapped.apply(lambda x: end_date_drug(end_dates, x), axis=1)#(lf)dataset_dddrugs_unwrapped = pd.DataFrame(dataset_drugs_unwrapped[""end_dates""].values.tolist(), index=dataset_drugs_unwrapped.index).add_prefix('end_date_')#(lf)#(lf)# Drop columns from copy#(lf)dataset_drugs_unwrapped = dataset_drugs_unwrapped.drop([""start_dates"", ""end_dates""], axis=1)#(lf)#(lf)dataset_drugs_unwrapped = pd.merge(dataset_drugs_unwrapped, dataset_ddrugs_unwrapped, left_index=True, right_index=True)#(lf)dataset_drugs_unwrapped = pd.merge(dataset_drugs_unwrapped, dataset_dddrugs_unwrapped, left_index=True, right_index=True)#(lf)#(lf)dataset_dddddrugs_unwrapped = pd.DataFrame(dataset_drug_freq[""Drug Name""].values.tolist(), index=dataset_drugs_unwrapped.index).add_prefix('freq_')#(lf)dataset_drugs_unwrapped = pd.merge(dataset_drugs_unwrapped, dataset_dddddrugs_unwrapped, left_index=True, right_index=True)#(lf)dataset_drugs_unwrapped[""frequency""] = dataset_drugs_unwrapped.apply(lambda x: drug_frequency_average(x), axis=1)#(lf)#(lf)dataset_ddddddrugs_unwrapped = pd.DataFrame(dataset_drugs_unwrapped[""frequency""].values.tolist(), index=dataset_drugs_unwrapped.index).add_prefix('spacing_')#(lf)dataset_drugs_unwrapped = pd.merge(dataset_drugs_unwrapped, dataset_ddddddrugs_unwrapped, left_index=True, right_index=True)#(lf)#(lf)dataset_dddddddrugs_unwrapped = pd.DataFrame(dataset_drug_freq[""Drug cost total""].values.tolist(), index=dataset_drugs_unwrapped.index).add_prefix('total_cost_drug_')#(lf)dataset_drugs_unwrapped = pd.merge(dataset_drugs_unwrapped, dataset_dddddddrugs_unwrapped, left_index=True, right_index=True)#(lf)dataset_drugs_unwrapped = dataset_drugs_unwrapped.drop([""frequency""], axis=1)#(lf)#(lf)# Insert first & last date seen into dataset#(lf)dataset_drugs_unwrapped.insert(0, ""First seen"", dataset_dates_unwrapped.min(axis=1))#(lf)dataset_drugs_unwrapped.insert(1, ""Last seen"", dataset_end_dates_unwrapped.max(axis=1))#(lf)#(lf)# Merge info from activity data with grouped info, and total cost info#(lf)patient_info = dataset.drop_duplicates(subset=""PersonKey"", keep=""first"").set_index(""PersonKey"")#(lf)patient_info = pd.merge(patient_info, dataset_drugs_unwrapped, left_index=True, right_index=True)#(lf)patient_info = pd.merge(patient_info, dataset_freq_unwrapped, left_index=True, right_index=True)#(lf)patient_info = pd.merge(patient_info, total_costs, left_index=True, right_index=True)#(lf)#(lf)# Fix patient_info drug handling - using loc to avoid SettingWithCopyWarning#(lf)patient_info = patient_info.assign(drug_0=patient_info['drug_0'].replace('N/A', np.nan))#(lf)patient_info = patient_info.dropna(subset=['drug_0'])#(lf)#(lf)# Filter initiation based on years provided#(lf)title = ""All patients""#(lf)#(lf)# Remove patients with 0 drug - create new DataFrame instead of modifying#(lf)patient_info = patient_info.assign(drug_0=patient_info['drug_0'].replace('N/A', np.nan))#(lf)patient_info = patient_info.dropna(subset=['drug_0'])#(lf)#(lf)# Calculate duration of treatment#(lf)patient_info = patient_info.assign(**{#(lf)    'Days treated': patient_info[""Last seen""] - patient_info[""First seen""]#(lf)})#(lf)date_dataset = patient_info[[""First seen"", ""Last seen"", 'Days treated']]#(lf)#(lf)# Create dataset for ice chart with hierarchy of plot#(lf)number_of_drugs = np.count_nonzero(patient_info.columns.str.startswith('drug_'))#(lf)final_drug_index = patient_info.columns.to_list().index(""drug_"" + str(number_of_drugs - 1))#(lf)#(lf)PersonKey_drugs_dataset = patient_info.iloc[:, (final_drug_index - number_of_drugs + 1):final_drug_index + 1].copy()#(lf)#(lf)PersonKey_drugs_dataset.insert(0, ""Trust"", PersonKey_drugs_dataset.index)#(lf)PersonKey_drugs_dataset.insert(1, ""Directory"", PersonKey_drugs_dataset.index)#(lf)#(lf)PersonKey_drugs_dataset = PersonKey_drugs_dataset.assign(#(lf)    Trust=PersonKey_drugs_dataset[""Trust""].map(trust_dataset[""OrganisationName""]),#(lf)    Directory=PersonKey_drugs_dataset[""Directory""].map(directory_dataset[""Directory""])#(lf))#(lf)#(lf)l_dataset = pd.DataFrame()#(lf)ice_dataset2 = pd.DataFrame()#(lf)ice_dataset = pd.DataFrame()#(lf)#(lf)PersonKey_drugs_dataset = PersonKey_drugs_dataset.assign(value=PersonKey_drugs_dataset.apply(lambda x: row_function(x), axis=1))#(lf)# Merge in date info#(lf)PersonKey_drugs_dataset = pd.merge(PersonKey_drugs_dataset, date_dataset, left_index=True, right_index=True)#(lf)#(lf)PersonKey_drugs_dataset = PersonKey_drugs_dataset.assign(ids=PersonKey_drugs_dataset[""value""].str.split(',').str[2])#(lf)avg_treatment_datasets = pd.DataFrame(PersonKey_drugs_dataset.groupby(""ids"", as_index=False)[""Days treated""].mean()).set_index(""ids"")#(lf)value_datasets = pd.DataFrame(PersonKey_drugs_dataset.groupby(""value"", as_index=False).size()).reset_index()#(lf)first_seen_treatment_datasets = pd.DataFrame(PersonKey_drugs_dataset.groupby(""ids"", as_index=False)[""First seen""].min()).set_index(""ids"")#(lf)last_seen_treatment_datasets = pd.DataFrame(PersonKey_drugs_dataset.groupby(""ids"", as_index=False)[""Last seen""].max()).set_index(""ids"")#(lf)#(lf)print(""Aggregating data into groups and finding average..."")#(lf)# Calculate total cost for parents#(lf)PersonKey_drugs_dataset = PersonKey_drugs_dataset.assign(Cost=PersonKey_drugs_dataset.index.map(total_costs[""Total cost""]))#(lf)cost_datasets = pd.DataFrame(PersonKey_drugs_dataset.groupby(""value"", as_index=False)['Cost'].sum()).set_index(""value"", drop=True)#(lf)#(lf)# Calculate average dosing for each drug#(lf)PersonKey_drugs_dataset = pd.merge(PersonKey_drugs_dataset, dataset_drugs_unwrapped, left_index=True, right_index=True)#(lf)#(lf)# Calculate average spacing between drugs#(lf)spacing_cols = [col for col in PersonKey_drugs_dataset.columns if 'spacing_' in col]#(lf)spacing_average = pd.DataFrame(PersonKey_drugs_dataset.groupby(""value"", as_index=False)[spacing_cols].mean()).set_index(""value"", drop=True)#(lf)spacing_average = spacing_average.round()#(lf)spacing_average = spacing_average.assign(#(lf)    combined=spacing_average.values.tolist(),#(lf)    ids=spacing_average.index.str.split(',').str[2]#(lf))#(lf)spacing_average = spacing_average.set_index(""ids"")#(lf)#(lf)# Calculate average cost for each drug#(lf)cost_cols = [col for col in PersonKey_drugs_dataset.columns if 'total_cost_drug_' in col]#(lf)cost_average = pd.DataFrame(PersonKey_drugs_dataset.groupby(""value"", as_index=False)[cost_cols].mean()).set_index(""value"", drop=True)#(lf)cost_average = cost_average.round(2)#(lf)cost_average = cost_average.assign(#(lf)    combined=cost_average.values.tolist(),#(lf)    ids=cost_average.index.str.split(',').str[2]#(lf))#(lf)cost_average = cost_average.set_index(""ids"")#(lf)#(lf)# Calculate average number of doses#(lf)freq_cols = [col for col in PersonKey_drugs_dataset.columns if 'freq_' in col]#(lf)freq_average = pd.DataFrame(PersonKey_drugs_dataset.groupby(""ids"", as_index=False)[freq_cols].mean()).set_index(""ids"", drop=True)#(lf)freq_average = freq_average.assign(combined=freq_average.values.tolist())#(lf)#(lf)# Remove negative totals from ""Cost"" column#(lf)#cost_datasets.loc[cost_datasets._get_numeric_data() < 0] = 0#(lf)#(lf)value_datasets = value_datasets.assign(Cost=value_datasets[""value""].map(cost_datasets[""Cost""]))#(lf)#(lf)ice_dataset = pd.DataFrame()#(lf)ice_dataset[['parents', 'labels', 'ids']] = value_datasets[""value""].str.split(',', expand=True)#(lf)# Filter rows where value_datasets[""value""] contains less than two "",""#(lf)#(lf)#(lf)#(lf)#(lf)ice_dataset = ice_dataset.assign(#(lf)    average_administered=ice_dataset[""ids""].map(freq_average[""combined""]),#(lf)    cost=value_datasets[""Cost""],#(lf)    value=value_datasets[""size""],#(lf)    average_cost=ice_dataset[""ids""].map(cost_average[""combined""]).apply(remove_nan_string),#(lf)    average_spacing=ice_dataset[""ids""].map(spacing_average[""combined""]).apply(remove_nan_string)#(lf))#(lf)#(lf)ice_dataset = ice_dataset.assign(#(lf)    average_spacing=ice_dataset.apply(lambda x: list_to_string(x), axis=1)#(lf))#(lf)ice_dataset.loc[:, 'average_spacing'] = ice_dataset['average_spacing'].str.replace(""nan"", ""N/A"")#(lf)#(lf)print(""Building graph dataframe structure."")#(lf)# Add very top level of Trust#(lf)new_row = pd.DataFrame({'parents': '', 'ids': ""N&WICS"", 'labels': 'N&WICS', 'value': 0, ""cost"": 0}, index=[0])#(lf)ice_dataset = pd.concat(objs=[ice_dataset, new_row], ignore_index=True, axis=0)#(lf)#(lf)# need to add parents as blocks...#(lf)l3 = [x for x in ice_dataset.parents.unique() if x not in ice_dataset.ids]#(lf)while len(l3) > 1:#(lf)    for l in l3:#(lf)        z = l.rfind(""-"")#(lf)        if z > 0:#(lf)            l_dict = {""parents"": l[:z - 1], ""ids"": l, ""value"": 0, ""labels"": l[z + 2:], ""cost"": 0}#(lf)            l_dataset = pd.concat([l_dataset, pd.DataFrame(l_dict, index=[0])], ignore_index=True)#(lf)    ice_dataset2 = pd.concat([ice_dataset, l_dataset], ignore_index=True)#(lf)    l3 = [x for x in ice_dataset2.parents.unique() if x not in ice_dataset2.ids.unique()]#(lf)ice_dataset = ice_dataset2.drop_duplicates(""ids"")#(lf)#(lf)ice_dataset = ice_dataset.assign(level=ice_dataset[""ids""].str.count('-'))#(lf)ice_dataset = ice_dataset[~ice_dataset['labels'].isin([""COST"", ""CHARGE"", ""N/A""])]#(lf)ice_dataset = ice_dataset.sort_values(by=[""level""], ascending=False, ignore_index=True)#(lf)#(lf)# Update values using loc to avoid SettingWithCopyWarning#(lf)for index, row in ice_dataset.iterrows():#(lf)    lookup_index = ice_dataset.index[ice_dataset['ids'] == row['parents']]#(lf)    ice_dataset.loc[lookup_index, 'value'] += ice_dataset.loc[index, ""value""]#(lf)    ice_dataset.loc[lookup_index, 'cost'] += ice_dataset.loc[index, 'cost']#(lf)#(lf)# Sum of parent values to create denominator for percentage - FOR COST COLOUR GRADING#(lf)colour_dataset = pd.DataFrame(ice_dataset.groupby([""parents""])[""cost""].sum())#(lf)ice_dataset = ice_dataset.assign(#(lf)    colour=ice_dataset[""parents""].map(colour_dataset[""cost""]),#(lf)    costpp=ice_dataset['cost'] / ice_dataset['value']#(lf))#(lf)ice_dataset.loc[:, 'colour'] = ice_dataset['cost'] / ice_dataset['colour']#(lf)#(lf)# Treatment length info#(lf)ice_dataset = ice_dataset.assign(#(lf)    avg_days=ice_dataset[""ids""].map(avg_treatment_datasets[""Days treated""]),#(lf)    First_seen=ice_dataset[""ids""].map(first_seen_treatment_datasets[""First seen""]),#(lf)    Last_seen=ice_dataset[""ids""].map(last_seen_treatment_datasets[""Last seen""])#(lf))#(lf)#(lf)# Rename First_Seen and Last_Seen columns to First seen and Last seen in ice_dataset#(lf)ice_dataset = ice_dataset.rename(columns={""First_seen"": ""First seen"", ""Last_seen"": ""Last seen""})#(lf)#(lf)#(lf)ice_dataset = ice_dataset.assign(dates=ice_dataset.apply(lambda x: min_max_treatment_dates(ice_dataset, x), axis=1))#(lf)ice_dataset[['First seen (Parent)', 'Last seen (Parent)']] = ice_dataset[""dates""].str.split(',', expand=True)#(lf)#(lf)# Convert dates and calculate cost per patient per annum#(lf)ice_dataset.loc[:, 'First seen'] = pd.to_datetime(ice_dataset['First seen'])#(lf)ice_dataset.loc[:, 'Last seen'] = pd.to_datetime(ice_dataset['Last seen'])#(lf)ice_dataset = ice_dataset.assign(cost_pp_pa=ice_dataset.apply(lambda x: cost_pp_pa(x), axis=1))#(lf)ice_dataset = ice_dataset.sort_values(by=[""labels""], ascending=True, ignore_index=True)#(lf)#(lf)# Final conversions#(lf)first_seen = ice_dataset['First seen'].astype(str).replace('NaT', 'N/A').to_list()#(lf)last_seen = ice_dataset['Last seen'].astype(str).replace('NaT', 'N/A').to_list()#(lf)first_seen_parent = ice_dataset['First seen (Parent)'].astype(str).to_list()#(lf)last_seen_parent = ice_dataset['Last seen (Parent)'].astype(str).to_list()#(lf)average_spacing = ice_dataset.average_spacing.astype(str).to_list()#(lf)avg_seen = ice_dataset['avg_days'].dt.round(""D"").astype(str).replace('0 days', 'N/A').to_list()",[dataset=#"Changed Type"]),
    ice_dataset = #"Run Python script1"{[Name="ice_dataset"]}[Value]
in
    ice_dataset